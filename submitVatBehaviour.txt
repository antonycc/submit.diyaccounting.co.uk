
> @antonycc/web-submit-diyaccounting-co-uk@1.0.0 test:submitVatBehaviour-proxy
> npx dotenv -e .env.proxy -- npm run test:submitVatBehaviour


> @antonycc/web-submit-diyaccounting-co-uk@1.0.0 test:submitVatBehaviour
> playwright test --project=submitVatBehaviour

dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:00.391Z","msg":"Reading CDK configuration from /Users/antony/projects/submit.diyaccounting.co.uk/cdk-application/cdk.json"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:00.391Z","msg":"CDK context:"}
dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.398Z","msg":"envFilePath: .env.proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.398Z","msg":"envName: proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.398Z","msg":"serverPort: 3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.398Z","msg":"runTestServer: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.398Z","msg":"runProxy: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.398Z","msg":"runMockOAuth2: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"testAuthProvider: mock"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"testAuthUsername: user"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"testAuthPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"baseUrl: https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"hmrcTestUsername: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"hmrcTestPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"hmrcTestVatNumber: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"runDynamoDb: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"bundleTableName: test-bundle-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.399Z","msg":"hmrcApiRequestsTableName: test-hmrc-api-requests-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.400Z","msg":"receiptsTableName: test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.400Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:00.400Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}

Running 1 test using 1 worker

dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:01.360Z","msg":"Reading CDK configuration from /Users/antony/projects/submit.diyaccounting.co.uk/cdk-application/cdk.json"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:01.360Z","msg":"CDK context:"}
dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"envFilePath: .env.proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"envName: proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"serverPort: 3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"runTestServer: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"runProxy: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"runMockOAuth2: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.366Z","msg":"testAuthProvider: mock"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.367Z","msg":"testAuthUsername: user"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.367Z","msg":"testAuthPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.367Z","msg":"baseUrl: https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.367Z","msg":"hmrcTestUsername: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.367Z","msg":"hmrcTestPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.369Z","msg":"hmrcTestVatNumber: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.369Z","msg":"runDynamoDb: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.369Z","msg":"bundleTableName: test-bundle-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.369Z","msg":"hmrcApiRequestsTableName: test-hmrc-api-requests-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.369Z","msg":"receiptsTableName: test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.370Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.370Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
Starting beforeAll hook...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.990Z","msg":"[dynamodb]: runDynamoDb=run, bundleTableName=test-bundle-table, hmrcApiRequestsTableName=test-hmrc-api-requests-table, receiptsTableName=test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.991Z","msg":"[dynamodb]: DYNAMODB_PORT not set; using ephemeral port (0)"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:01.991Z","msg":"[dynamodb]: Starting dynalite (local DynamoDB) server..."}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:02.005Z","msg":"[dynamodb]: Started at http://127.0.0.1:57365"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.005Z","msg":"[dynamodb]: Ensuring bundle table: 'test-bundle-table' exists on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.041Z","msg":"[dynamodb]: ℹ️ Table 'test-bundle-table' not found on endpoint 'http://127.0.0.1:57365', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.048Z","msg":"[dynamodb]: ✅ Created table 'test-bundle-table' on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.048Z","msg":"[dynamodb]: Ensuring HMRC API requests table: 'test-hmrc-api-requests-table' exists on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.057Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-api-requests-table' not found on endpoint 'http://127.0.0.1:57365', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.060Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-api-requests-table' on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.060Z","msg":"[dynamodb]: Ensuring receipts table: 'test-receipts-table' exists on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.065Z","msg":"[dynamodb]: ℹ️ Table 'test-receipts-table' not found on endpoint 'http://127.0.0.1:57365', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.067Z","msg":"[dynamodb]: ✅ Created table 'test-receipts-table' on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.067Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-return-post-async-requests-table' exists on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.071Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-return-post-async-requests-table' not found on endpoint 'http://127.0.0.1:57365', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.073Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-return-post-async-requests-table' on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.073Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-return-get-async-requests-table' exists on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.081Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-return-get-async-requests-table' not found on endpoint 'http://127.0.0.1:57365', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.084Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-return-get-async-requests-table' on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.084Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-obligation-get-async-requests-table' exists on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.088Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-obligation-get-async-requests-table' not found on endpoint 'http://127.0.0.1:57365', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T00:05:02.090Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-obligation-get-async-requests-table' on endpoint 'http://127.0.0.1:57365'"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:02.090Z","msg":"[auth]: runMockOAuth2=run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:02.090Z","msg":"[auth]: Starting mock-oauth2-server process..."}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:02.093Z","msg":"[auth]: Checking server readiness for... http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:02.104Z","msg":"[auth]: Starting server at http://localhost:8080/default/debugger after error TypeError: fetch failed"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:02.105Z","msg":"[auth]: Server check attempt 1/15 failed: fetch failed from http://localhost:8080/default/debugger"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:04.109Z","msg":"[auth]: Server check attempt 2/15 failed: fetch failed from http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:06.278Z","msg":"[auth]: Response body"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:06.278Z","msg":"[auth]: Server is ready! at http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.278Z","msg":"[http]: runTestServer=run, httpServerPort=3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.278Z","msg":"[http]: Starting server process..."}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:06.280Z","msg":"[http]: Checking server readiness for... http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:06.281Z","msg":"[http]: Starting server at http://127.0.0.1:3000 after error TypeError: fetch failed"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:06.282Z","msg":"[http]: Server check attempt 1/15 failed: fetch failed from http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.473Z","msg":"[http-stdout]: dotenvConfigIfNotBlank: Loading environment config from .env"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.484Z","msg":"[http-stdout]: dotenvConfigIfNotBlank: Loading environment config from .env"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.488Z","msg":"[http-stdout]: Mock OAuth routes registered (TEST_AUTH_PROVIDER=mock)"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.491Z","msg":"[http-stdout]: Listening at http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:06.492Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:06.492Z\",\"msg\":\"Listening at http://127.0.0.1:3000\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:07.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:07.289Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:07.297Z","msg":"[http]: Response body"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:07.298Z","msg":"[http]: Server is ready! at http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:07.298Z","msg":"[proxy]: runProxy=run, httpServerPort=3000, baseUrl=https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:07.298Z","msg":"[proxy]: Starting ngrok tunnel using @ngrok/ngrok..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T00:05:07.298Z","msg":"[ngrok]: Starting ngrok tunnel for address: 3000, domain: wanted-finally-anteater.ngrok-free.app, pooling: true"}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T00:05:07.704Z","msg":"[ngrok]: ✅ Tunnel established at https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:07.704Z","msg":"[proxy]: Started at https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:07.704Z","msg":"[proxy]: Checking server readiness for... https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:07.954Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:07.953Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T00:05:08.013Z","msg":"[proxy]: Server is ready! at https://wanted-finally-anteater.ngrok-free.app"}
beforeAll hook completed successfully
[HMRC Test User] Sandbox mode detected without full credentials - creating test user
[HMRC Test User] Creating HMRC sandbox test user with VAT enrolment using client credentials
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:09.519Z","message":"[HMRC Test User Creation] Starting test user creation","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","serviceNames":["mtd-vat"],"hmrcClientId":"uqMHA6Rs..."}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:09.519Z","message":"[HMRC Test User Creation] Request details (pre-token)","method":"POST","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","body":{"serviceNames":["mtd-vat"]}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:09.520Z","message":"[HMRC Test User Creation] Requesting OAuth2 access token","tokenUrl":"https://test-api.service.hmrc.gov.uk/oauth/token","grantType":"client_credentials"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:09.827Z","message":"[HMRC Test User Creation] Token response received","status":200,"statusText":"OK","hasAccessToken":true}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:09.827Z","message":"[HMRC Test User Creation] Request details (create-test-user)","method":"POST","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"[REDACTED]"},"body":{"serviceNames":["mtd-vat"]}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.331Z","message":"[HMRC Test User Creation] Response received","status":201,"statusText":"Created","responseBody":{"userId":"359127156654","password":"[REDACTED]","userFullName":"Yasmine Elson","emailAddress":"[REDACTED]","organisationDetails":{"name":"Company GIRNW4","address":{"line1":"5 Edgware Road","line2":"Bath","postcode":"TS8 1PA"}},"individualDetails":{"firstName":"Yasmine","lastName":"Elson","dateOfBirth":"1941-02-02","address":{"line1":"21 Upper Street","line2":"Fleet","postcode":"TS15 1PA"}},"vatRegistrationDate":"2006-01-29","groupIdentifier":"842905412191","vrn":"965899632"}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.331Z","message":"[HMRC Test User Creation] Test user created successfully","userId":"359127156654","userFullName":"Yasmine Elson","organisationName":"Company GIRNW4"}
[HMRC Test User] Successfully created test user:
  User ID: 359127156654
  User Full Name: Yasmine Elson
  VAT registration number: 965899632
  Organisation: Company GIRNW4
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.331Z","message":"[HMRC Test User] Saving test user details to JSON files","outputDir":"/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour","repoRoot":"/Users/antony/projects/submit.diyaccounting.co.uk"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.332Z","message":"[HMRC Test User] Saved test user to artifact directory","path":"/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-test-user.json"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.332Z","message":"[HMRC Test User] Saved test user to repository root","path":"/Users/antony/projects/submit.diyaccounting.co.uk/hmrc-test-user.json"}
[HMRC Test User] Updated environment variables with generated credentials
Loading document...
[NAVIGATION] (1/4) Going to: https://wanted-finally-anteater.ngrok-free.app/ - Loading home page
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.712Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.904Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.904Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.931Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.930Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.932Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.931Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.934Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.933Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.937Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.935Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.941Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.937Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.954Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.947Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.960Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.960Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:10.961Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:10.961Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.018Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.017Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.019Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.018Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.022Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.020Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.027Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.023Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.030Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.030Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.031Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.031Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.031Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.031Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.033Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.033Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.034Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.034Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
[BROWSER CONSOLE log]: User is not authenticated
[BROWSER CONSOLE log]: User is not authenticated
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.142Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.142Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.143Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.161Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.152Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.284Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.284Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Checking home page...
✅ [Compliance] Privacy link visible on home page
✅ [Compliance] Terms link visible on home page
[USER INTERACTION] Clicking: a:has-text('Log in') - Clicking login link
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:11.908Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:11.908Z\",\"msg\":\"HTTP GET /auth/login.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.005Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.005Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.011Z\",\"msg\":\"HTTP GET /images/g-logo.png\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.014Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.014Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.014Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.014Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.015Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.015Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.015Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.015Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.026Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.026Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.062Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.062Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.063Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.062Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.062Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.063Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.063Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.063Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.063Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.064Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.064Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.067Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.067Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.190Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.191Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.194Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.194Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.196Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.197Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.197Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.198Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.198Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.199Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.198Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.199Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.199Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.225Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.225Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.230Z\",\"msg\":\"HTTP GET /auth/login-mock-addon.js\"}"}
[BROWSER CONSOLE error]: Loading the image 'https://avatars.githubusercontent.com/u/11848947?s=48&v=4' violates the following Content Security Policy directive: "img-src 'self' data:". The action has been blocked.
[HTTP REQUEST FAILED] GET https://avatars.githubusercontent.com/u/11848947?s=48&v=4 - csp
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.298Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.297Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.298Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.298Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
Logging in...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.443Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.442Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: button:has-text('Continue with mock-oauth2-server') - Continue with OAuth provider
[BROWSER CONSOLE log]: Initiating navikt/mock-oauth2-server login
[BROWSER CONSOLE log]: Clear stored tokens and user info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.950Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:12.950Z\",\"msg\":\"HTTP GET /api/v1/mock/authUrl?state=10905481d55582001c2672b9e2b99eaa\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.953Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:12.952Z\",\"requestId\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/mock/authUrl?state=10905481d55582001c2672b9e2b99eaa\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"cognito:username\":\"test\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/mock/authUrl\"}},\"path\":\"/api/v1/mock/authUrl\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/auth/login.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\"},\"queryStringParameters\":{\"state\":\"10905481d55582001c2672b9e2b99eaa\"},\"rawQueryString\":\"state=10905481d55582001c2672b9e2b99eaa\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.953Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/non-lambda-mocks/mockAuthUrlGet.js\",\"time\":\"2026-01-29T00:05:12.953Z\",\"requestId\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"message\":\"Generating mock authorization URL\",\"state\":\"10905481d55582001c2672b9e2b99eaa\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:12.953Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:12.953Z\",\"requestId\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/mock/authUrl?state=10905481d55582001c2672b9e2b99eaa\",\"response\":{\"statusCode\":200,\"headers\":{\"x-request-id\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"94247ce0-1e62-497d-872d-b826cbb4da2f\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"authUrl\\\":\\\"http://localhost:8080/oauth/authorize?response_type=code&client_id=debugger&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Fauth%2FloginWithMockCallback.html&scope=openid%20somescope&state=10905481d55582001c2672b9e2b99eaa&identity_provider=MockOAuth2Server\\\"}\"}}"}
[BROWSER CONSOLE log]: Status message: Handing off to http://localhost:8080/oauth/authorize?response_type=code&client_id=debugger&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Fauth%2FloginWithMockCallback.html&scope=openid%20somescope&state=10905481d55582001c2672b9e2b99eaa&identity_provider=MockOAuth2Server Type: info
[BROWSER CONSOLE log]: Redirecting to navikt/mock-oauth2-server
[USER INTERACTION] Filling: input[name="username"] with value: "user" - Entering username
[USER INTERACTION] Filling: textarea[name="claims"] with value: "{"email":"user@example.com"}" - Entering identity claims
[USER INTERACTION] Clicking: input[type="submit"][value="Sign-in"] - Submitting sign-in form
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:15.850Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:15.849Z\",\"msg\":\"HTTP GET /auth/loginWithMockCallback.html?code=I5FmjATN72WpwqcCeZotgnyHTURI5d940n-DgjXb9XQ&state=10905481d55582001c2672b9e2b99eaa\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.034Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.034Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.035Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.035Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.064Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.064Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.065Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.065Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.066Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.065Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.066Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.066Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.067Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.067Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.068Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.125Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.125Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.144Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.144Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.151Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.150Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.152Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.152Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
[BROWSER CONSOLE log]: Authentication callback received with code: I5FmjATN72WpwqcCeZotgnyHTURI5d940n-DgjXb9XQ
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.154Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.154Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.155Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.157Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.157Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.159Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.158Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.227Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.227Z\",\"msg\":\"HTTP POST /api/v1/mock/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.283Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.283Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[BROWSER CONSOLE log]: Received tokens from mock {"token_type":"Bearer","id_token":"eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg","access_token":"eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg","refresh_token":"da48c861-172d-4852-959b-e1bc173fc8dc","expires_in":3599}
[BROWSER CONSOLE log]: Received id_token from mock {"sub":"user","aud":"debugger","nbf":1769645116,"scope":"openid somescope","amr":["mfa","pwd"],"iss":"http://localhost:8080/default","exp":1769648716,"iat":1769645116,"nonce":"5678","jti":"6122e857-a122-47cd-833b-cce8715b1b21","email":"user@example.com"}
[BROWSER CONSOLE log]: User authenticated successfully using mock: user@example.com
[BROWSER CONSOLE log]: MFA detected from mock IdP: [mfa, pwd] Stored metadata: {type: OTHER, timestamp: 2026-01-29T00:05:16.487Z, uniqueReference: 354308f0-c16d-4601-8b5a-95436500fadf}
[BROWSER CONSOLE log]: Status message: Authenticated successfully. Fetching bundles... Type: info
[BROWSER CONSOLE log]: Status message: Authenticated successfully. Redirecting... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.524Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.523Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.629Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.629Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.630Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.630Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.631Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.631Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.632Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.632Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.633Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.633Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.635Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.634Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.635Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.635Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.636Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.636Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.637Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.637Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.738Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.738Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.744Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.745Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.745Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.746Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.746Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.746Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.746Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.747Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.747Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.748Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.749Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.749Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.750Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.749Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.853Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.853Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.853Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.853Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.854Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:16.854Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.854Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/subHasher.js\",\"time\":\"2026-01-29T00:05:16.854Z\",\"message\":\"Using USER_SUB_HASH_SALT from environment (local dev/test)\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.854Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:16.854Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.855Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.854Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.855Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:16.855Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.855Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.855Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.855Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.855Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.855Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.855Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.856Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:16.856Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.857Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.860Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.860Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.860Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:16.860Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.980Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.980Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.980Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.980Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.980Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.980Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.980Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:16.980Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.980Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:16.980Z\",\"requestId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6581b87e-52bc-4956-bad5-eefd13a90df1\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.982Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.981Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.982Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:16.982Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.982Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:16.982Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.982Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:16.982Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:16.982Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:16.982Z\",\"requestId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"759ec219-2f63-446c-b00f-1d90a4da93ba\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:17.022Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:17.022Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:17.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:17.069Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
Checking home page...
[BROWSER CONSOLE log]: [Mock MFA] Injected MFA metadata: {type: TOTP, timestamp: 2026-01-08T00:09:01Z, uniqueReference: test-mfa-1769645118386}
[Mock MFA] Injected: type=TOTP, timestamp=2026-01-08T00:09:01Z, ref=test-mfa-1769645118386
CloudWatch RUM analytics consent dialog is visible, accepting...
[USER INTERACTION] Clicking: button:has-text("Accept") - Accept CloudWatch RUM consent
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
Navigating to Bundles via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Bundles') - Clicking Bundles in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.002Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.002Z\",\"msg\":\"HTTP GET /account/bundles.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.091Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.091Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.091Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.091Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.106Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.106Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.118Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.117Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.120Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.119Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.120Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.120Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.121Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.121Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.121Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.122Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.123Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.123Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.124Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.124Z\",\"msg\":\"HTTP GET /lib/bundle-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.125Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.124Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.182Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.182Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.185Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.185Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.186Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.187Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.189Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.188Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.189Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.189Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.190Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.243Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.243Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.244Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:19.243Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.244Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:19.244Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.244Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.244Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.244Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:19.244Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.244Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.244Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.244Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.245Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.256Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.255Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.255Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.255Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:19.255Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:19.255Z\",\"requestId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"correlationId\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"x-correlationid\":\"02f4f892-9094-49b2-bd4b-0757299b8fdb\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.292Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.292Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.300Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.300Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.300Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.300Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.301Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:19.301Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.301Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:19.301Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.301Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.301Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.301Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:19.301Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.301Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.301Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.302Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.302Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.305Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:19.305Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:19.305Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:19.305Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:19.305Z\",\"requestId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"635b2e9e-db37-4388-b723-d0e2bdd0e51a\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.389Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.388Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.389Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.389Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.468Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:19.468Z\",\"msg\":\"HTTP GET /submit.environment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:19.942Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
Ensuring Test bundle is present...
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (1/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (2/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (3/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (4/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (5/5)
[polling to ensure present]: Test bundle still not present.
Test bundle not present, requesting...
Requesting Test bundle...
[polling be ready to request]: Test bundle request button already visible.
[USER INTERACTION] Clicking: button:has-text('Request Test') - Request Test
[BROWSER CONSOLE log]: Status message: Requesting bundle "Test"... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.228Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:26.228Z\",\"msg\":\"HTTP POST /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.229Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:26.228Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.229Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:26.229Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"35\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"bundleId\\\":\\\"test\\\",\\\"qualifiers\\\":{}}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.229Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.229Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Processing bundle request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:26.229Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.230Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Processing bundle request for user\",\"userId\":\"user\",\"bundleId\":\"test\",\"waitTimeMs\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:26.230Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Executing synchronous processing\",\"userId\":\"user\",\"waitTimeMs\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.230Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"grantBundle entry\",\"userId\":\"user\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.230Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.230Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.236Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.236Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.236Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.236Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.240Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.240Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Loaded catalog bundle:\",\"bundleId\":\"test\",\"catalogBundle\":{\"id\":\"test\",\"name\":\"Test\",\"allocation\":\"on-request\",\"cap\":10,\"timeout\":\"P1D\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.240Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.240Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"[Catalog bundle] Bundle requires manual allocation, proceeding:\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.240Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.240Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"[Catalog bundle] Bundle cap not yet reached:\",\"requestedBundle\":\"test\",\"currentCount\":0,\"cap\":10}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.240Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.240Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Granting bundle to user:\",\"userId\":\"user\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.241Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.240Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"New bundle details:\",\"newBundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.241Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.241Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Updated user bundles:\",\"userId\":\"user\",\"currentBundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.241Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.241Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Updating bundles for user user with 1\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.241Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.241Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.242Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.241Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.244Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Current bundles for user user in DynamoDB count: 0\",\"currentBundles\":[]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Current bundle IDs for user user in DynamoDB count: undefined\",\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"New bundle IDs for user user count: undefined\",\"newBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Bundles to remove for user user in DynamoDB\",\"bundlesToRemove\":[]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Checking if bundle test needs adding for user user in DynamoDB\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Adding new bundle test for user user in DynamoDB\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"putBundle [table: test-bundle-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.245Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Storing bundle\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"userId\":\"user\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.246Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.245Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Storing bundle in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"item\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.251Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.250Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Bundle stored in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"item\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.251Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:26.251Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Updated bundles for user user in DynamoDB\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.251Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T00:05:26.251Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Bundle granted to user:\",\"userId\":\"user\",\"newBundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:26.251Z\",\"requestId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"969b39d1-127a-4e5d-b81a-b42735ee2541\",\"message\":\"Returning result with status 201\"}"}
[BROWSER CONSOLE log]: Status message: Bundle "Test" added successfully. Type: success
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.331Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:26.331Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.331Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:26.331Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.331Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:26.331Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.332Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.331Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.332Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:26.332Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.332Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.332Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.332Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.332Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.333Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.332Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.333Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.333Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.338Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.338Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.338Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:26.338Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:26.338Z\",\"requestId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"c54898f3-4d23-4fca-97ce-e9d9c48782d7\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
[polling to ensure request completed]: Test bundle already present.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.443Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:26.443Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.443Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:26.443Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.444Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.444Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.444Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.444Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.444Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.444Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.444Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.448Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.448Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.448Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:26.448Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.448Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:26.448Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:26.448Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.449Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:26.448Z\",\"requestId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4cfce80d-9b99-44ab-83cd-0f5444b6e269\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
Returning to home via home icon...
[USER INTERACTION] Clicking: .home-link - Home icon
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:26.904Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:26.904Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.011Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.067Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.068Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.086Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.086Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.086Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.086Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.090Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.090Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.091Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.091Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.093Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.093Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.094Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.093Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.163Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.162Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.164Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.164Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.171Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.171Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.172Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.172Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.172Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.172Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.173Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.173Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.174Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.175Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.174Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.175Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.175Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.289Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:27.289Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4bcf2076-6401-4e33-9726-449775a27571\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.290Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.292Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.293Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"d720861d-98b5-4f30-9e97-0c2d43313527\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.294Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.296Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.296Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.297Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.297Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.297Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:27.297Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:27.297Z\",\"requestId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4bcf2076-6401-4e33-9726-449775a27571\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.299Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.299Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.300Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:27.299Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.300Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:27.300Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:27.300Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.300Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:27.300Z\",\"requestId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"d720861d-98b5-4f30-9e97-0c2d43313527\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.402Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.402Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.407Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:27.407Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:27.950Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: button:has-text('Submit VAT (HMRC Sandbox)') - Starting VAT return submission
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.764Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.764Z\",\"msg\":\"HTTP GET /hmrc/vat/submitVat.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.855Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.888Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.888Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.889Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.889Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.918Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.918Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.927Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.927Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.928Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.928Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.931Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.930Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.932Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.931Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.932Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.932Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.933Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.933Z\",\"msg\":\"HTTP GET /lib/utils/obligation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.934Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.934Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:28.934Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:28.934Z\",\"msg\":\"HTTP GET /submit.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.063Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.063Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.070Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.072Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.073Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.073Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.075Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.075Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.076Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.077Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.077Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.078Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.078Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (no action taken)
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.178Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:29.178Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.180Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.179Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.182Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.182Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.182Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:29.182Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:29.182Z\",\"requestId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"29f67242-f0ab-4e7e-bec9-3fe25f20958a\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.184Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.186Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:29.186Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:29.186Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.188Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.187Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.190Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.190Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:29.190Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:29.190Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:29.191Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:29.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:29.191Z\",\"requestId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"3d91f8b2-4319-4d87-8131-b042c3bb2895\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:30.419Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated 9-box VAT submission form with test data: {vatDueSales: 548.00, vatDueAcquisitions: 0.00, totalVatDue: 548.00, vatReclaimedCurrPeriod: 250.00, netVatDue: 298.00}
[BROWSER CONSOLE log]: [Test Data] Auto-checked allowSandboxObligations for sandbox testing
[USER INTERACTION] Filling: #vatNumber with value: "965899632" - Entering VAT number
Set period dates: 2017-01-01 to 2017-03-31
[USER INTERACTION] Filling: #vatDueSales with value: "1000.00" - Entering VAT due on sales (Box 1)
[USER INTERACTION] Filling: #vatDueAcquisitions with value: "0.00" - Entering VAT due on acquisitions (Box 2)
[USER INTERACTION] Filling: #vatReclaimedCurrPeriod with value: "0.00" - Entering VAT reclaimed (Box 4)
[USER INTERACTION] Filling: #totalValueSalesExVAT with value: "5000" - Entering total sales ex VAT (Box 6)
[USER INTERACTION] Filling: #totalValuePurchasesExVAT with value: "0" - Entering total purchases ex VAT (Box 7)
[USER INTERACTION] Filling: #totalValueGoodsSuppliedExVAT with value: "0" - Entering goods supplied to EU (Box 8)
[USER INTERACTION] Filling: #totalAcquisitionsExVAT with value: "0" - Entering acquisitions from EU (Box 9)
Enabled developer mode for test scenario
Developer section visible (controlled by global developer mode)
Checked runFraudPreventionHeaderValidation checkbox
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:34.208Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
allowSandboxObligations checkbox already checked
[USER INTERACTION] Focusing: #submitBtn - the Submit button
[USER INTERACTION] Clicking: #submitBtn - Submitting VAT form
[BROWSER CONSOLE log]: Status message: Initiating HMRC authentication... Type: info
[BROWSER CONSOLE log]: Stored pending request and current activity: {"vatNumber":"965899632","periodStart":"2017-01-01","periodEnd":"2017-03-31","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":5000,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0,"finalised":true,"testScenario":"","runFraudPreventionHeaderValidation":true,"allowSandboxObligations":true} /hmrc/vat/submitVat.html sandbox
[BROWSER CONSOLE log]: Using client-side generated HMRC Auth URL: https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=e8d30b2a688349f092bee9cd806b8c0f
[BROWSER CONSOLE log]: Current activity set to: /hmrc/vat/submitVat.html
[BROWSER CONSOLE log]: Status message: Redirecting to HMRC for authentication at https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=e8d30b2a688349f092bee9cd806b8c0f... Type: info
[BROWSER CONSOLE log]: Page transition initiated: Redirecting to HMRC OAuth URL https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=e8d30b2a688349f092bee9cd806b8c0f
[USER INTERACTION] Clicking: Continue button - Continuing with HMRC permission
[USER INTERACTION] Clicking: [Locator] - Continue
[USER INTERACTION] Clicking: Sign in to HMRC button - Starting HMRC authentication
[USER INTERACTION] Clicking: [Locator] - Sign in to the HMRC online service
[BROWSER ERROR]: Cannot read properties of null (reading 'addEventListener')
[BROWSER ERROR]: Cannot read properties of undefined (reading 'initAll')
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.341Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.340Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.411Z\",\"msg\":\"HTTP GET /submit.css\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.412Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.414Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.414Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.415Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.418Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.417Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.420Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.420Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.420Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.423Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.423Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.467Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.467Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.467Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.467Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.468Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.468Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.470Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.470Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.470Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.470Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.472Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.471Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.472Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.472Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.472Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.472Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.476Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.475Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.487Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.486Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.487Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.487Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.490Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.490Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:41.499Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:41.499Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Filling: #userId with value: "359127156654" - Entering HMRC user ID
[USER INTERACTION] Filling: #password with value: "FGn6vDyvuVCE" - Entering HMRC password
[USER INTERACTION] Clicking: Sign in button - Submitting HMRC credentials
[USER INTERACTION] Clicking: [Locator] - Sign in
[USER INTERACTION] Clicking: #givePermission - Give permission
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:45.937Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:45.937Z\",\"msg\":\"HTTP GET /activities/submitVatCallback.html?code=42527e99fecb42adb063d7dabcc9f259&state=e8d30b2a688349f092bee9cd806b8c0f\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.108Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.108Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.113Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.113Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.114Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.113Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.144Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.144Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.174Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.174Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.175Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.175Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.176Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.175Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.282Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.280Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.281Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.310Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.308Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.320Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.320Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.326Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.324Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.331Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.329Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.332Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.332Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.333Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.333Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.335Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.335Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: OAuth callback handler
[BROWSER CONSOLE log]: Page transition initiated: Clearing URL parameters
[BROWSER CONSOLE log]: OAuth callback handler (normal completion)
[BROWSER CONSOLE log]: Status message: Exchanging authorization code for access token... Type: info
[BROWSER CONSOLE log]: Exchanging token. Remote call initiated: POST /api/v1/hmrc/token ++ Body: {"code":"42527e99fecb42adb063d7dabcc9f259"}
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.469Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.469Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.470Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.470Z\",\"msg\":\"HTTP POST /api/v1/hmrc/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.470Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:46.470Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.471Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.471Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/token\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/token\"}},\"path\":\"/api/v1/hmrc/token\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"43\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"55714473-ea5b-4496-96b8-8bc5b137a400\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"code\\\":\\\"42527e99fecb42adb063d7dabcc9f259\\\"}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.471Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-29T00:05:46.471Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"Exchanging authorization code for HMRC access token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.472Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-29T00:05:46.471Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"msg\":\"Retrieving HMRC client secret from arn \"}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-29T00:05:46.471Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"msg\":\"Secret retrieved from override and cached\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.473Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.473Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/oauth/token\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"headers\":{\"Content-Type\":\"application/x-www-form-urlencoded\",\"x-request-id\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"55714473-ea5b-4496-96b8-8bc5b137a400\"},\"body\":\"grant_type=authorization_code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&client_secret=a2dd6f2e-c7e0-4d3c-aeb2-0506b9c35f56&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&code=42527e99fecb42adb063d7dabcc9f259\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.473Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.473Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"Performing HTTP POST for token exchange\",\"providerUrl\":\"https://test-api.service.hmrc.gov.uk/oauth/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.523Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.523Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"b543292b-24c8-4234-81f7-514e4a86b42c\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.523Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.523Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.523Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.524Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:46.523Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.524Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:46.524Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.527Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.526Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.528Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:46.528Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.528Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:46.528Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:46.528Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.528Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:46.528Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.528Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.528Z\",\"requestId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"b543292b-24c8-4234-81f7-514e4a86b42c\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.751Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.751Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"HTTP POST response received with status and duration\",\"status\":200,\"duration\":278}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.752Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:46.752Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.757Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:46.757Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.758Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.757Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"exchangeClientSecretForAccessToken response\",\"responseStatus\":200,\"responseTokens\":{\"access_token\":\"[REDACTED]\",\"refresh_token\":\"[REDACTED]\",\"expires_in\":14400,\"scope\":\"write:vat read:vat\",\"token_type\":\"bearer\"},\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"tokenType\":\"bearer\",\"scope\":\"write:vat read:vat\",\"expiresIn\":14400,\"hasRefreshToken\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.758Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.757Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"Token exchange succeeded\",\"accessTokenLength\":32,\"hasIdToken\":false,\"hasRefreshToken\":true,\"expiresIn\":14400,\"tokenType\":\"bearer\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.758Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:46.758Z\",\"requestId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/token\",\"response\":{\"statusCode\":200,\"headers\":{\"x-request-id\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"55714473-ea5b-4496-96b8-8bc5b137a400\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"accessToken\\\":\\\"901a6717bbcf5ef619a7ad2ea85d2c0f\\\",\\\"hmrcAccessToken\\\":\\\"901a6717bbcf5ef619a7ad2ea85d2c0f\\\",\\\"refreshToken\\\":\\\"39c1bbb5d78cbe600718794886480253\\\",\\\"expiresIn\\\":14400,\\\"tokenType\\\":\\\"bearer\\\"}\"}}"}
[BROWSER CONSOLE log]: Exchanged token. Remote call completed successfully: POST /api/v1/hmrc/token {accessToken: 901a6717bbcf5ef619a7ad2ea85d2c0f, hmrcAccessToken: 901a6717bbcf5ef619a7ad2ea85d2c0f, refreshToken: 39c1bbb5d78cbe600718794886480253, expiresIn: 14400, tokenType: bearer} 901a6717bbcf5ef619a7ad2ea85d2c0f
[BROWSER CONSOLE log]: Status message: Obtained Access Token from HMRC... Type: info
[BROWSER CONSOLE log]: Current activity found: /hmrc/vat/submitVat.html
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.828Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.828Z\",\"msg\":\"HTTP GET /hmrc/vat/submitVat.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.944Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.944Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.952Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.952Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.955Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.955Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.956Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.956Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.957Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.957Z\",\"msg\":\"HTTP GET /lib/utils/obligation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.957Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.957Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.958Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.958Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.958Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.958Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.959Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.959Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.960Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.960Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.960Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.960Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:46.961Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:46.961Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.050Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.050Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.052Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.052Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.065Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.065Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.070Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.072Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.073Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.073Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.074Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.074Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.074Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: Restored form draft from 2026-01-29T00:05:33.717Z
[BROWSER CONSOLE log]: OAuth callback handler (code present, auto-continue)
[BROWSER CONSOLE log]: Retrieved submission data: {vatNumber: 965899632, periodStart: 2017-01-01, periodEnd: 2017-03-31, vatDueSales: 1000, vatDueAcquisitions: 0}
[BROWSER CONSOLE log]: Status message: Submitting VAT return to HMRC... Type: info
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.173Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.173Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.173Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.173Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:47.173Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.174Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.175Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.174Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.177Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.176Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.177Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.177Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.177Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.179Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.179Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.179Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.179Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.179Z\",\"requestId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4744fe04-4a1f-4012-a0bf-8300118fa5c6\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.181Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.181Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:47.182Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.182Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.182Z\",\"requestId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"1e3ac7ad-9a35-4e2c-a07a-9324583029fb\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
[BROWSER CONSOLE log]: Submitting VAT. Remote call initiated: POST /api/v1/hmrc/vat/return ++ Body: {"vatNumber":"965899632","periodStart":"2017-01-01","periodEnd":"2017-03-31","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":5000,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0,"finalised":true,"accessToken":"901a6717bbcf5ef619a7ad2ea85d2c0f","runFraudPreventionHeaderValidation":true}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.260Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:47.260Z\",\"msg\":\"HTTP POST /api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.260Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:47.260Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.261Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.261Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:05:47.219Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"7e54c0f9-e701-4a7d-b356-ea42aa393750\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"965899632\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"901a6717bbcf5ef619a7ad2ea85d2c0f\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.261Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.261Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.261Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.261Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.261Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.261Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.262Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.261Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:05:47.219Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"7e54c0f9-e701-4a7d-b356-ea42aa393750\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"965899632\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"901a6717bbcf5ef619a7ad2ea85d2c0f\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.263Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.263Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.263Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.263Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.263Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.263Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.266Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.266Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.266Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:47.266Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.266Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.266Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:47.267Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.268Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.268Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"901a6717...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.268Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.268Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Checking for test scenario\":null}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.268Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.268Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vatNumber\":\"965899632\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.268Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:05:47.268Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.268Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.439Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.439Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.439Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.439Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.439Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.439Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.439Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.442Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.442Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.443Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.443Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:05:47.219Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.602Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.601Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.602Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.602Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.604Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.604Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.606Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.605Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Validating fraud prevention headers for sandbox account\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.606Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.606Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.607Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.607Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.607Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.607Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.615Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.615Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.615Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.615Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.615Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.615Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.616Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:47.616Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:05:47.219Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Retry-After\":\"5\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [POST /api/v1/hmrc/vat/return] (timeout: 1630000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... (poll #1) Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.736Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.735Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.736Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.736Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.736Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.736Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.736Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.739Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.739Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.739Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.739Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:05:47.219Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"body\":{\"periodKey\":\"18A1\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":5000,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0,\"finalised\":true},\"environment\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.739Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.739Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"method\":\"POST\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:05:47.219Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"body\":\"{\\\"periodKey\\\":\\\"18A1\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true}\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.879Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:47.879Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Response from POST https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"status\":201,\"hmrcResponseBody\":{\"processingDate\":\"2026-01-29T00:05:47.866Z\",\"formBundleNumber\":\"760864409184\",\"paymentIndicator\":\"DD\",\"chargeRefNumber\":\"a8k4ovRD7AWd6EAo\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.879Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.879Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.882Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:47.882Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Received HMRC response: {}\",\"httpResult\":{\"hmrcResponse\":{},\"hmrcResponseBody\":{\"processingDate\":\"2026-01-29T00:05:47.866Z\",\"formBundleNumber\":\"760864409184\",\"paymentIndicator\":\"DD\",\"chargeRefNumber\":\"a8k4ovRD7AWd6EAo\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:47.882Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putReceipt [table: test-receipts-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:47.882Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Storing receipt\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"userSub\":\"user\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:47.882Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Storing receipt in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\",\"ttl_datestamp\":\"2033-01-27T00:05:47.882Z\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.884Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:47.884Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Receipt stored in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.885Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.884Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.885Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:47.885Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.885Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.885Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:47.889Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:47.888Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [POST /api/v1/hmrc/vat/return] (poll #1, elapsed: 1000ms, timeout: 1630000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:48.713Z\",\"msg\":\"HTTP POST /api/v1/hmrc/vat/return\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:48.713Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.714Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:48.713Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:05:47.219Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"7e54c0f9-e701-4a7d-b356-ea42aa393750\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"965899632\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"901a6717bbcf5ef619a7ad2ea85d2c0f\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.713Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.713Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.713Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.714Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:48.714Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:05:47.219Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"7e54c0f9-e701-4a7d-b356-ea42aa393750\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"965899632\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"901a6717bbcf5ef619a7ad2ea85d2c0f\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.715Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:48.715Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:48.715Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:48.718Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:48.718Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.718Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.719Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:48.719Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.719Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"901a6717...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:48.719Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Checking for test scenario\":null}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.720Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:48.719Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vatNumber\":\"965899632\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.720Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:05:48.720Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.720Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.720Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.852Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.852Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.852Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.852Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.853Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:48.852Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:48.856Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.856Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:05:47.219Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.971Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:05:48.971Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.971Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:48.971Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:05:48.974Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:48.974Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:48.974Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.976Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:05:48.976Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.976Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:48.976Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T00:05:48.976Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Found persisted request\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.976Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:48.976Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:48.976Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:48.976Z\",\"requestId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"cc348638-9259-453b-abe6-cca5cab47015\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:05:47.219Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"6056f89e-2a97-47d7-8e04-2d5f19751dff\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"receipt\\\":{\\\"processingDate\\\":\\\"2026-01-29T00:05:47.866Z\\\",\\\"formBundleNumber\\\":\\\"760864409184\\\",\\\"paymentIndicator\\\":\\\"DD\\\",\\\"chargeRefNumber\\\":\\\"a8k4ovRD7AWd6EAo\\\"},\\\"hmrcResponse\\\":{\\\"ok\\\":true,\\\"status\\\":201,\\\"statusText\\\":\\\"Created\\\",\\\"headers\\\":{\\\"cache-control\\\":\\\"no-cache,no-store,max-age=0\\\",\\\"connection\\\":\\\"keep-alive\\\",\\\"content-length\\\":\\\"140\\\",\\\"content-security-policy\\\":\\\"default-src 'self'\\\",\\\"content-type\\\":\\\"application/json\\\",\\\"date\\\":\\\"Thu, 29 Jan 2026 00:05:47 GMT\\\",\\\"receipt-id\\\":\\\"696d0b89-c2f8-45f6-8e29-f6f05c3b7050\\\",\\\"receipt-signature\\\":\\\"This has been deprecated - DO NOT USE\\\",\\\"receipt-timestamp\\\":\\\"2026-01-29T00:05:47Z\\\",\\\"strict-transport-security\\\":\\\"max-age=31536000;\\\",\\\"vary\\\":\\\"Origin\\\",\\\"via\\\":\\\"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)\\\",\\\"x-amz-cf-id\\\":\\\"UuIOCk5lAuwd1Jkg_yN-hOa21tUiN-geQgg793gSySnpux3yG6cfTw==\\\",\\\"x-amz-cf-pop\\\":\\\"AMS1-P1\\\",\\\"x-cache\\\":\\\"Miss from cloudfront\\\",\\\"x-content-type-options\\\":\\\"nosniff, nosniff\\\",\\\"x-correlationid\\\":\\\"696d0b89-c2f8-45f6-8e29-f6f05c3b7050\\\",\\\"x-envoy-upstream-service-time\\\":\\\"35\\\",\\\"x-frame-options\\\":\\\"SAMEORIGIN\\\"}},\\\"hmrcResponseBody\\\":{\\\"processingDate\\\":\\\"2026-01-29T00:05:47.866Z\\\",\\\"formBundleNumber\\\":\\\"760864409184\\\",\\\"paymentIndicator\\\":\\\"DD\\\",\\\"chargeRefNumber\\\":\\\"a8k4ovRD7AWd6EAo\\\"},\\\"periodKey\\\":\\\"18A1\\\",\\\"receiptId\\\":\\\"2026-01-29T00:05:47.882Z-760864409184\\\"}\"}}"}
[BROWSER CONSOLE log]: finished async request [POST /api/v1/hmrc/vat/return] (poll #1, elapsed: 1363ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT return processed Type: success
[BROWSER CONSOLE log]: Page display transition: Displaying receipt and hiding form {receipt: Object, hmrcResponse: Object, hmrcResponseBody: Object, periodKey: 18A1, receiptId: 2026-01-29T00:05:47.882Z-760864409184}
[BROWSER CONSOLE log]: Continue submission handler (success, session storage cleared)
[Test] Captured resolved periodKey from response: 18A1
Waiting for VAT submission to complete and receipt to be displayed...
Current URL: https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox
Page title: Submit VAT Return - DIY Accounting
Body element exists: true
Main content element exists: true
Receipt element exists: true
Receipt element style: display: block;
Form element exists: true
Form element style: display: none;
Receipt element visible: true
formBundleNumber validated: 760864409184
chargeRefNumber validated: a8k4ovRD7AWd6EAo
processingDate validated: 29 January 2026 at 01:05 (parsed as 2026-01-29T00:05:00.000Z)
VAT submission flow completed successfully with validated receipt fields
Navigating to Receipts via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Receipts') - Clicking Receipts in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.708Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.708Z\",\"msg\":\"HTTP GET /hmrc/receipt/receipts.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.809Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.809Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.820Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.820Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.821Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.821Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.834Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.834Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.835Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.835Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.835Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.835Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.836Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.856Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.857Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.950Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.949Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.950Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.950Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.952Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.952Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.952Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.952Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.953Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.953Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.964Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.964Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.974Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.974Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:51.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:51.975Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:52.067Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:52.068Z\",\"msg\":\"HTTP GET /api/v1/hmrc/receipt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:52.068Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.069Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:52.071Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.071Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt\"}},\"path\":\"/api/v1/hmrc/receipt\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.071Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.071Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.071Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.071Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt\"}},\"path\":\"/api/v1/hmrc/receipt\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.072Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.072Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.073Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.074Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.074Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.074Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.074Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:52.074Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.075Z\",\"requestId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"ae98b9a2-1579-44c9-8112-70998afa8b02\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:52.075Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt\",\"requiredBundleIds\":[\"default\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcReceiptGet.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Listing user receipts\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"DynamoDB enabled, proceeding with listUserReceipts [table: test-receipts-table]\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.077Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:52.076Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Retrieving receipts from DynamoDB\",\"userSub\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.078Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:52.077Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.078Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:52.078Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.079Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.081Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:52.080Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Queried DynamoDB for user receipts\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.081Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:52.081Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Retrieved receipts from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.081Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.081Z\",\"requestId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"73c1379a-a8b1-4238-a313-3dd813c8e747\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"receipts\\\":[{\\\"receiptId\\\":\\\"2026-01-29T00:05:47.882Z-760864409184\\\",\\\"key\\\":\\\"receipts/user/2026-01-29T00:05:47.882Z-760864409184.json\\\",\\\"name\\\":\\\"2026-01-29T00:05:47.882Z-760864409184.json\\\",\\\"timestamp\\\":\\\"2026-01-29T00:05:47.882Z\\\",\\\"formBundleNumber\\\":\\\"760864409184\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:47.882Z\\\",\\\"lastModified\\\":\\\"2026-01-29T00:05:47.882Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.082Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:52.082Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:52.082Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:52.082Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:52.082Z\",\"requestId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"3dcdddc4-6bf3-4258-8d1e-0676f613f295\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:52.164Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:52.164Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Checking receipts page...
Found receipts, clicking on first receipt...
[USER INTERACTION] Clicking: [Locator] - Open first receipt
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.743Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:53.743Z\",\"msg\":\"HTTP GET /api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:53.743Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:53.744Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\"}},\"path\":\"/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"29bf8875-109a-4aca-b090-d760b4e20e21\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{\"name\":\"2026-01-29T00:05:47.882Z-760864409184.json\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.744Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.744Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.744Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:53.744Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\"}},\"path\":\"/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"29bf8875-109a-4aca-b090-d760b4e20e21\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{\"name\":\"2026-01-29T00:05:47.882Z-760864409184.json\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.745Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.745Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.745Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:53.745Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.745Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:53.745Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\",\"requiredBundleIds\":[\"default\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T00%3A05%3A47.882Z-760864409184.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcReceiptGet.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Retrieving single receipt\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\",\"key\":\"receipts/user/2026-01-29T00:05:47.882Z-760864409184.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"DynamoDB enabled, proceeding with getReceipt [table: test-receipts-table]\",\"userSub\":\"user\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.748Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:53.748Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Retrieving receipt from DynamoDB\",\"userSub\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:53.750Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T00:05:53.750Z\",\"requestId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"29bf8875-109a-4aca-b090-d760b4e20e21\",\"message\":\"Retrieved receipt from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T00:05:47.882Z-760864409184\"}"}
Returning to home via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Activities') - Clicking Activities in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.663Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.663Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.770Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.769Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.832Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.832Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.833Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.832Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.846Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.846Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.847Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.847Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.848Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.847Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.848Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.848Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.862Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.862Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.863Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.863Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.920Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.919Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.930Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.930Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.931Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.931Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.931Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.931Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.932Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.932Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.932Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.932Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.933Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.933Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.933Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.933Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:54.934Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:54.934Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.028Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.028Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.028Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:55.028Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"83853b58-667e-4041-a3c3-863575f64ccf\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.029Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.032Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.031Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.032Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.032Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.032Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.032Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.032Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:55.032Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.032Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:55.032Z\",\"requestId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"83853b58-667e-4041-a3c3-863575f64ccf\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.033Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.033Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.036Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.036Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.036Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"b136ae13-fbed-49b5-b113-3feef9b76137\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.038Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.038Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.037Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.038Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.038Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.040Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:55.040Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:55.040Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:55.040Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:55.040Z\",\"requestId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"b136ae13-fbed-49b5-b113-3feef9b76137\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.109Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.149Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.149Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.153Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: button:has-text('View VAT Return (HMRC Sandbox)') - Starting View VAT Return
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:55.903Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.903Z\",\"msg\":\"HTTP GET /hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.001Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:55.998Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.042Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.042Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.045Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.044Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.046Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.045Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.046Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.046Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.047Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.047Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.047Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.047Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.063Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.063Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.063Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.063Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.064Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.064Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.068Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.130Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.130Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.130Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.130Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.132Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.131Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.133Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.132Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.136Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.136Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.136Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.136Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.137Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.137Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.139Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.138Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.139Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.139Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.140Z\",\"msg\":\"HTTP GET /submit.env\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (accessToken found)
[BROWSER CONSOLE log]: No pending return request found
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.230Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.230Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.230Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.232Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.232Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.231Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.232Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.232Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.234Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:05:56.233Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.234Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"896ea924-9301-4451-ad3a-1be0645f72c3\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.234Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.234Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.234Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.234Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.234Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.236Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.236Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.236Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.236Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:56.236Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:56.236Z\",\"requestId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"e15476c8-916f-4c1a-ad86-ccd92af026d1\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.237Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.237Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.237Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:05:56.237Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:05:56.237Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.237Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:05:56.237Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:56.237Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:05:56.237Z\",\"requestId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"896ea924-9301-4451-ad3a-1be0645f72c3\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:05:57.447Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated view VAT return form with test data
[USER INTERACTION] Filling: #vrn with value: "965899632" - Entering VAT registration number
Set period dates: 2017-01-01 to 2017-03-31
Enabled developer mode for test scenario
Developer section visible (controlled by global developer mode)
Checked runFraudPreventionHeaderValidation checkbox
[USER INTERACTION] Focusing: #retrieveBtn - Retrieve button
[USER INTERACTION] Clicking: #retrieveBtn - Submitting view VAT return form
[BROWSER CONSOLE log]: Status message: Retrieving VAT return... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.480Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:00.479Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.480Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:00.480Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.481Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:00.481Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:00.420Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"b8b4b2c6-b910-4606-8d76-d64ddb513b27\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.481Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.481Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.481Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.481Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.481Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.481Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:00.481Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:00.420Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"b8b4b2c6-b910-4606-8d76-d64ddb513b27\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.482Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.482Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.482Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:00.482Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.482Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:00.482Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.485Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:00.485Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.485Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:00.485Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.485Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.485Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.485Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.485Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.485Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:00.485Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.486Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.486Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"901a6717...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.486Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:00.486Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\"}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:00.486Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vrn\":\"965899632\"}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:00.486Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.486Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.486Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.709Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.709Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.709Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.709Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.709Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.710Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.709Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.715Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.715Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:00.420Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.901Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.901Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.902Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.901Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.905Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.905Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.907Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:00.906Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Validating fraud prevention headers for sandbox account\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.907Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:00.907Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.908Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:00.907Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.908Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.908Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.912Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:00.912Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:00.912Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:00.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:00.912Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:00.420Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"Retry-After\":\"5\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [GET /api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true] (timeout: 730000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:01.068Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.068Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:01.068Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:01.068Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}\n{\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:01.068Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:01.071Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:01.072Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:00.420Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.209Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:01.208Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1\",\"status\":200,\"hmrcResponseBody\":{\"periodKey\":\"18A1\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":5000,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.209Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:01.209Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.211Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:01.211Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.212Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:01.211Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.212Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:01.211Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-return-get-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:01.211Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:01.214Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:01.214Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [GET /api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true] (poll #1, elapsed: 1001ms, timeout: 730000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.010Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:02.010Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.010Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:02.010Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:02.010Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:00.420Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"b8b4b2c6-b910-4606-8d76-d64ddb513b27\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.011Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.011Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.011Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:02.011Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:00.420Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"b8b4b2c6-b910-4606-8d76-d64ddb513b27\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.013Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.013Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.013Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:02.013Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.013Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:02.013Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.016Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:02.016Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.017Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:02.016Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.017Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.017Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.017Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.017Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:02.017Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.017Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.017Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"901a6717...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.018Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:02.017Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\"}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:02.018Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vrn\":\"965899632\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.018Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:02.018Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.018Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.018Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.210Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.210Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.210Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.210Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.210Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.210Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:02.210Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.214Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:02.214Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.215Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.215Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:00.420Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.359Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:02.359Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.359Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:02.359Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.362Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:02.361Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.362Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:02.362Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.362Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:02.362Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.364Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:02.364Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.364Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:02.364Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T00:06:02.364Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Found persisted request\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.364Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:02.364Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:02.364Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:02.364Z\",\"requestId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:00.420Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"periodKey\\\":\\\"18A1\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0}\"}}"}
[BROWSER CONSOLE log]: finished async request [GET /api/v1/hmrc/vat/return?vrn=965899632&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true] (poll #1, elapsed: 1455ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT return retrieved. Type: success
[BROWSER CONSOLE log]: Hiding all status messages
VAT due on sales validated: £1000.00
VAT due on acquisitions validated: £0.00
Total VAT due validated: £1000.00
VAT reclaimed on purchases validated: £0.00
View VAT return completed successfully with validated fields
Returning to home via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Activities') - Clicking Activities in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.368Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.368Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.449Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.449Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.465Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.464Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.486Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.485Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.486Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.486Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.487Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.487Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.487Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.487Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.503Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.503Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.504Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.504Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.504Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.504Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.608Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.608Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.609Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.609Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.611Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.611Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.612Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.612Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.613Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.613Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.614Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.614Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.615Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.615Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.615Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.615Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.616Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.616Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.710Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.710Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.712Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:03.712Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:03.712Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.713Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:03.713Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.713Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.713Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.713Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.713Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.714Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:03.714Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:03.714Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.715Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:03.715Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.715Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.715Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.715Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.715Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.716Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.717Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.717Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.717Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.717Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.717Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.717Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.717Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:03.717Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.717Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:03.717Z\",\"requestId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"f84e7396-ecdc-447a-9e04-d0a553e2ee33\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.718Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:03.718Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:03.718Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:03.718Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:03.718Z\",\"requestId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"80c8b8fe-d05c-49ca-b347-b039f7d9d254\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.778Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.808Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.808Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:03.809Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:03.809Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[USER INTERACTION] Clicking: button:has-text('VAT Obligations (HMRC Sandbox)') - Starting VAT Obligations
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.551Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.550Z\",\"msg\":\"HTTP GET /hmrc/vat/vatObligations.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.657Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.670Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.738Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.714Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.734Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.742Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.741Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.743Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.742Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.743Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.743Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.744Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.744Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.745Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.745Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.746Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.746Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.747Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.747Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.853Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.853Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.854Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.854Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.856Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.857Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.857Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.862Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.862Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.863Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.863Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.864Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.864Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.865Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.865Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.866Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.866Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.866Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.866Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (accessToken found)
[BROWSER CONSOLE log]: No pending obligations request found
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.968Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.968Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:04.968Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"d8ce8252-d657-482f-80c6-f34f8e757288\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.969Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.971Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.971Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.972Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.973Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.973Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:04.973Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:04.973Z\",\"requestId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"d8ce8252-d657-482f-80c6-f34f8e757288\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:04.974Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:04.974Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:04.974Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"596f6363-449e-4d12-911b-c150b9478651\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.974Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:04.975Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.975Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.975Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.975Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.975Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.978Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.978Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.978Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:04.978Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:04.978Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.978Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:04.978Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:04.978Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:04.978Z\",\"requestId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"596f6363-449e-4d12-911b-c150b9478651\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"596f6363-449e-4d12-911b-c150b9478651\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"596f6363-449e-4d12-911b-c150b9478651\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:06.324Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated VAT obligations form with test data
[USER INTERACTION] Filling: #vrn with value: "965899632" - Entering VAT registration number
[USER INTERACTION] Filling: #fromDate with value: "2025-01-01" - Entering from date
[USER INTERACTION] Filling: #toDate with value: "2025-12-01" - Entering to date
[USER INTERACTION] Focusing: #status - the obligations status filter
[USER INTERACTION] Focusing: #retrieveBtn - Retrieve button
[USER INTERACTION] Clicking: #retrieveBtn - Submitting VAT obligations form
[BROWSER CONSOLE log]: Status message: Retrieving VAT obligations... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.511Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:09.511Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.512Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:09.512Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.513Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:09.512Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:09.419Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"92df1476-a5f6-4b04-9e23-e7146dec4681\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=965899632&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.513Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.513Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.513Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.513Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.513Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.513Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:09.513Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:09.419Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"92df1476-a5f6-4b04-9e23-e7146dec4681\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=965899632&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.514Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:09.514Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:09.514Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:09.517Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:09.517Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.518Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.518Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:09.518Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:09.518Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"901a6717...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Skipping fraud prevention header validation for HMRC API request\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":false}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.520Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:09.519Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:09.419Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.522Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:09.521Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.522Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.521Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.526Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.526Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:09.526Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:09.526Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:09.419Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"Retry-After\":\"5\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [GET /api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01] (timeout: 730000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:09.718Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"},{\"periodKey\":\"18A2\",\"start\":\"2017-04-01\",\"end\":\"2017-06-30\",\"due\":\"2017-08-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.719Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.721Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.721Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.721Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:09.721Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.721Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:09.721Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.722Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.721Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:09.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:09.724Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [GET /api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01] (poll #1, elapsed: 1001ms, timeout: 730000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.650Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:10.650Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.650Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:10.650Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.650Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:10.650Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:09.419Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"92df1476-a5f6-4b04-9e23-e7146dec4681\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=965899632&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.651Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.650Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.651Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.651Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.651Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.651Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:10.651Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"3a618499-cf0b-44c8-8305-99030ac5554a\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 901a6717bbcf5ef619a7ad2ea85d2c0f\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T00:06:09.419Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiM2E2MTg0OTktY2YwYi00NGM4LTgzMDUtOTkwMzBhYzU1NTRhIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Wd56lzm3IHtNZQCh2WcE4gK87k-KaZ0tZWi7EFqjGWmWP8wsjMlwBF4CKXtDEUQ9372z4UzCAiaVWvrbhp5EKWiMz8uenr6LA9_6sjgYlrpBq-uN9zcX9Pbj-mK469jRSVR4f8xXudCCXNKriqgeGamThnbJJ_2ygA_gDbCVmLRNf7xI7MHcyVHJSgoTRm5GW-aaJPlIaiE6dkdPrWGFH2pZQX67Eb_LEAVXy0OnTOPVvJCsV1uYfcCxhq3XtIkVVuyP8ZAjWv94Jfu58g_GUnrMEcBSBhPOeEkrJiQbuQmhE5khb0-0WQmzWL9zoj45YxqjPMm5NLn4P2GDnXQ2xg\",\"x-client-request-id\":\"92df1476-a5f6-4b04-9e23-e7146dec4681\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"965899632\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=965899632&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.652Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.652Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.652Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:10.652Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:10.652Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.655Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:10.655Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.655Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:10.655Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.655Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T00:05:26.245Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.655Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.655Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.655Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T00:06:10.655Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.656Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T00:06:10.656Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"901a6717...\",\"isValidFormat\":true}}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:10.656Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.656Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:10.656Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.658Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T00:06:10.658Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.658Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:10.658Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T00:06:10.658Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Found persisted request\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.658Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:10.658Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:10.658Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:10.658Z\",\"requestId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"a6dfc069-07dc-4794-93e0-f5226b0ed506\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T00:06:09.419Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"obligations\\\":[{\\\"periodKey\\\":\\\"18A1\\\",\\\"start\\\":\\\"2017-01-01\\\",\\\"end\\\":\\\"2017-03-31\\\",\\\"due\\\":\\\"2017-05-07\\\",\\\"status\\\":\\\"F\\\",\\\"received\\\":\\\"2017-05-06\\\"},{\\\"periodKey\\\":\\\"18A2\\\",\\\"start\\\":\\\"2017-04-01\\\",\\\"end\\\":\\\"2017-06-30\\\",\\\"due\\\":\\\"2017-08-07\\\",\\\"status\\\":\\\"O\\\"}]}\"}}"}
[BROWSER CONSOLE log]: finished async request [GET /api/v1/hmrc/vat/obligation?vrn=965899632&from=2025-01-01&to=2025-12-01] (poll #1, elapsed: 1139ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT obligations retrieved. Type: success
[BROWSER CONSOLE log]: Hiding all status messages
[verifyVatObligationsResults] Found 2 obligation(s) - validating shape
VAT Period validated: 1 Jan 2017 to 31 Mar 2017
VAT Period validated: 1 Apr 2017 to 30 Jun 2017
Dates validated for 1 Jan 2017 to 31 Mar 2017: due=7 May 2017, received=6 May 2017
Dates validated for 1 Apr 2017 to 30 Jun 2017: due=7 Aug 2017, received=-
No test scenario 1 fulfilled obligations and 1 open obligations
VAT obligations retrieval completed successfully
Returning to home via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Activities') - Clicking Activities in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.028Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.028Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.113Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.112Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.113Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.113Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.114Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.114Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.145Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.145Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.146Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.146Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.146Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.146Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.147Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.147Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.148Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.210Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.210Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.212Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.211Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.212Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.212Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.213Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.213Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.214Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.214Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.215Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.214Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.215Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.216Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.216Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.217Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.216Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.323Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.322Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.323Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.324Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.324Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.326Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.325Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk2NDUxMTYsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk2NDg3MTYsImlhdCI6MTc2OTY0NTExNiwibm9uY2UiOiI1Njc4IiwianRpIjoiNjEyMmU4NTctYTEyMi00N2NkLTgzM2ItY2NlODcxNWIxYjIxIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.V5dSYC_jWc5FWtMHVoFtlunS7evy4XhMkH-SqlC7vg16QWeRDnrqXl3TgyalH5lC2SCnMo4uGDMraqxKTHzPIy32eK1LSND2pCcYR8fnz4TosTFX9QMgubNwmqMwPEmVe6mBClph_OUWRR1qaxu1LoHzynrZc39Q5Hq-deSvQ5mPWalJsFk3PcCVHAuCLkCfYG_hKsPef3eUYdQJXNJPBnoTHvv8Y5DYMjOujAMn5AXVBK9Y6Mj7k3cLn7OT_XkpazCcaKXeLzzvzvT26XGJWek8WcSpiw7mjY0Qk83WY1esr8ccYAaHytQFCPFW8qGcgWsZUFYHvrpBy7iJBiGzzg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769645116,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769648716,\"iat\":1769645116,\"nonce\":\"5678\",\"jti\":\"6122e857-a122-47cd-833b-cce8715b1b21\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.326Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.326Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.328Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.327Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.328Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.328Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.329Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.328Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.329Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:12.329Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.329Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:12.329Z\",\"requestId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"44e9376f-b81b-4cae-a1c5-7dc23d699fbf\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.330Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.329Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.330Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T00:06:12.330Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.330Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T00:06:12.330Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.330Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T00:06:12.330Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.330Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T00:06:12.330Z\",\"requestId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"correlationId\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"traceparent\":\"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01\",\"x-correlationid\":\"d4e3780b-2039-4eae-81cc-569965e70b9e\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T00:05:26.245Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
[test body] Found userInfo in localStorage for test "Click through: Submit a VAT return to HMRC": {"sub":"user","email":"user@example.com"}
[test body] Extracted userSub from localStorage for test "Click through: Submit a VAT return to HMRC": user
Logging out from home page
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.424Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.423Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.429Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.429Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[USER INTERACTION] Clicking: a:has-text('Logout') - Logout
[BROWSER CONSOLE log]: Logging out user
[HTTP REQUEST FAILED] GET https://wanted-finally-anteater.ngrok-free.app/index.html - net::ERR_ABORTED
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.763Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.763Z\",\"msg\":\"HTTP GET /auth/login.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.851Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.851Z\",\"msg\":\"HTTP GET /images/g-logo.png\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.851Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.851Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.859Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.859Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.869Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.869Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.870Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.870Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.870Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.870Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.875Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.875Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.875Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.875Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.882Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.882Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.882Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.882Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.882Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.883Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.883Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.884Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.883Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.991Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.991Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.992Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.992Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.993Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.993Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.994Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.994Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.995Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.995Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.995Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.995Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.996Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.996Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.997Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.997Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.998Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.998Z\",\"msg\":\"HTTP GET /auth/login-mock-addon.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:12.999Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:12.999Z\",\"msg\":\"HTTP GET /submit.env\"}"}
[BROWSER CONSOLE error]: Loading the image 'https://avatars.githubusercontent.com/u/11848947?s=48&v=4' violates the following Content Security Policy directive: "img-src 'self' data:". The action has been blocked.
[HTTP REQUEST FAILED] GET https://avatars.githubusercontent.com/u/11848947?s=48&v=4 - csp
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:13.099Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:13.099Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:13.103Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:13.103Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:13.172Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:13.172Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[Figures]: Selected 5 key screenshots from target/behaviour-test-results/screenshots/submitVat-behaviour-test
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T00:06:13.178Z","msg":"Copied screenshot: 2026-01-29_00-05-34-284598434-10-fill-in-submission-pagedown.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T00:06:13.179Z","msg":"Copied screenshot: 2026-01-29_00-05-49-667568920-02-complete-vat-receipt.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T00:06:13.180Z","msg":"Copied screenshot: 2026-01-29_00-05-42-180472303-01-submit-hmrc-auth.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T00:06:13.180Z","msg":"Copied screenshot: 2026-01-29_00-06-02-145304271-03-view-vat-return-results.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T00:06:13.180Z","msg":"Copied screenshot: 2026-01-29_00-05-15-064397809-00-focus-submitting-sign-in-form.png"}
[Figures]: Copied 5 screenshots to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T00:06:13.181Z","msg":"Wrote figures.json with 5 entries to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/figures.json"}
[Figures]: Generated figures.json in /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour
[DynamoDB Export]: Starting export of all tables...
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.181Z","msg":"[dynamodb-export]: Starting export of all tables to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.182Z","msg":"[dynamodb-export]: Exporting table 'test-bundle-table' from endpoint 'http://127.0.0.1:57365' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.194Z","msg":"[dynamodb-export]: ✅ Exported 1 items from table 'test-bundle-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.194Z","msg":"[dynamodb-export]: ── BEGIN bundles.jsonl ──"}
{"bundleId":"test","expiry":"2026-01-30T00:00:00.000Z","hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","createdAt":"2026-01-29T00:05:26.245Z","ttl":1772409600,"ttl_datestamp":"2026-03-02T00:00:00.000Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.194Z","msg":"[dynamodb-export]: ── END bundles.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.194Z","msg":"[dynamodb-export]: Exporting table 'test-hmrc-api-requests-table' from endpoint 'http://127.0.0.1:57365' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.203Z","msg":"[dynamodb-export]: ✅ Exported 14 items from table 'test-hmrc-api-requests-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.203Z","msg":"[dynamodb-export]: ── BEGIN hmrc-api-requests.jsonl ──"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-09cd099a-d921-46cd-922a-ed610994c75b","requestId":"6056f89e-2a97-47d7-8e04-2d5f19751dff","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"cc348638-9259-453b-abe6-cca5cab47015","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:05:47.219Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"6056f89e-2a97-47d7-8e04-2d5f19751dff","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"6056f89e-2a97-47d7-8e04-2d5f19751dff"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:47 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"j9bKWGljB_rbmlCothShnG8KBmpLKA7SJZJdjteObwhoKXLVRSn9gw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"42","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":129,"createdAt":"2026-01-29T00:05:47.736Z","ttl":1772323547,"ttl_datestamp":"2026-03-01T00:05:47.736Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-289e8606-bce2-46b6-bb0c-500b49a19d31","requestId":"6056f89e-2a97-47d7-8e04-2d5f19751dff","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns","method":"POST","httpRequest":{"method":"POST","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"6056f89e-2a97-47d7-8e04-2d5f19751dff","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"6056f89e-2a97-47d7-8e04-2d5f19751dff","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"cc348638-9259-453b-abe6-cca5cab47015","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:05:47.219Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"},"body":"{\"periodKey\":\"18A1\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":5000,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0,\"finalised\":true}"},"httpResponse":{"statusCode":201,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"140","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:47 GMT","receipt-id":"696d0b89-c2f8-45f6-8e29-f6f05c3b7050","receipt-signature":"This has been deprecated - DO NOT USE","receipt-timestamp":"2026-01-29T00:05:47Z","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"UuIOCk5lAuwd1Jkg_yN-hOa21tUiN-geQgg793gSySnpux3yG6cfTw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"696d0b89-c2f8-45f6-8e29-f6f05c3b7050","x-envoy-upstream-service-time":"35","x-frame-options":"SAMEORIGIN"},"body":{"processingDate":"2026-01-29T00:05:47.866Z","formBundleNumber":"760864409184","paymentIndicator":"DD","chargeRefNumber":"a8k4ovRD7AWd6EAo"}},"duration":140,"createdAt":"2026-01-29T00:05:47.879Z","ttl":1772323547,"ttl_datestamp":"2026-03-01T00:05:47.879Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-354d85ca-fddf-437a-94bb-34a9e3e80f93","requestId":"6056f89e-2a97-47d7-8e04-2d5f19751dff","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"6056f89e-2a97-47d7-8e04-2d5f19751dff","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"6056f89e-2a97-47d7-8e04-2d5f19751dff","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"cc348638-9259-453b-abe6-cca5cab47015","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:05:47.219Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"110","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:48 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"w1gw_NNtJ9A_5uUUKjiyWqdxFI8f8PzvRZGMir3751GpLikWRp8lKQ==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"84afc226-2f4b-4b71-bcc2-70d739b2ac1a","x-envoy-upstream-service-time":"17","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"O"}]}},"duration":114,"createdAt":"2026-01-29T00:05:48.971Z","ttl":1772323548,"ttl_datestamp":"2026-03-01T00:05:48.971Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-544f7243-ff12-4793-9298-803afa71c7d6","requestId":"6056f89e-2a97-47d7-8e04-2d5f19751dff","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"cc348638-9259-453b-abe6-cca5cab47015","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:05:47.219Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"6056f89e-2a97-47d7-8e04-2d5f19751dff","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"6056f89e-2a97-47d7-8e04-2d5f19751dff"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:48 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"Tsowwud1w6VU1Ra5z2MilOvoKYhlrJcHsZtA6YfZGTiVdUq8TIKCwg==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"27","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":132,"createdAt":"2026-01-29T00:05:48.853Z","ttl":1772323548,"ttl_datestamp":"2026-03-01T00:05:48.853Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-80f6e66f-9d18-42d5-8c65-ae56ab9cdca2","requestId":"55714473-ea5b-4496-96b8-8bc5b137a400","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/oauth/token","method":"POST","httpRequest":{"method":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","x-request-id":"55714473-ea5b-4496-96b8-8bc5b137a400","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"55714473-ea5b-4496-96b8-8bc5b137a400"},"body":"grant_type=authorization_code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&client_secret=***MASKED***&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&code=***MASKED***"},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"172","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:46 GMT","strict-transport-security":"max-age=31536000;","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"su9rQEczTNSC2Npmk0j3sJfioG-NLkS2SdKXZUG94Ea7NB5IcM68rA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"59","x-frame-options":"SAMEORIGIN"},"body":{"access_token":"***MASKED***","refresh_token":"***MASKED***","expires_in":14400,"scope":"write:vat read:vat","token_type":"bearer"}},"duration":278,"createdAt":"2026-01-29T00:05:46.752Z","ttl":1772323546,"ttl_datestamp":"2026-03-01T00:05:46.752Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-9a451adf-22ac-40d7-bef4-f46fe4e12cfb","requestId":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:00.420Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"134","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:00 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 a8b68315e1e2575143f97748ffbb29a0.cloudfront.net (CloudFront)","x-amz-cf-id":"hJTVw6BR_ivmKdoQj4CtklpfUONX6rgtQE63_3TDDM98YnEMIcHclA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"d3343e7e-1003-42fe-853c-9e6368882505","x-envoy-upstream-service-time":"15","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"}]}},"duration":185,"createdAt":"2026-01-29T00:06:00.902Z","ttl":1772323560,"ttl_datestamp":"2026-03-01T00:06:00.902Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-ab9ae064-02d9-4499-b420-a135290cb21b","requestId":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:00.420Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"242","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:01 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 a8b68315e1e2575143f97748ffbb29a0.cloudfront.net (CloudFront)","x-amz-cf-id":"5JJIvq7ZL9Fszro1t_IHhiX88SNakKs5nUw5y0jMxSu8WwuFhUqOjQ==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"b2c4d887-fbe6-4fea-903a-ece72eb9f5b2","x-envoy-upstream-service-time":"16","x-frame-options":"SAMEORIGIN"},"body":{"periodKey":"18A1","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":5000,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0}},"duration":136,"createdAt":"2026-01-29T00:06:01.209Z","ttl":1772323561,"ttl_datestamp":"2026-03-01T00:06:01.209Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-b554ce88-c25c-4ce9-b71f-5074baceab19","requestId":"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2025-01-01&to=2025-12-01","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"a35db0c6-8e9d-47e8-9c5f-3c66307e1b1c","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"a6dfc069-07dc-4794-93e0-f5226b0ed506","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:09.419Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"227","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:09 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 29676c2ee539645954aa742bde1ce894.cloudfront.net (CloudFront)","x-amz-cf-id":"JjQk1rW-ADBucsY6von4-Vpqg_HVxI_f_gHJvok_EQaaZaCNW7obDA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"7290860b-b3d6-4a77-8306-5f5b9d86b53e","x-envoy-upstream-service-time":"16","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"},{"periodKey":"18A2","start":"2017-04-01","end":"2017-06-30","due":"2017-08-07","status":"O"}]}},"duration":199,"createdAt":"2026-01-29T00:06:09.719Z","ttl":1772323569,"ttl_datestamp":"2026-03-01T00:06:09.719Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-b95d0e23-3244-4d7b-babb-4123ad2eab5b","requestId":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:00.420Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:01 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 a8b68315e1e2575143f97748ffbb29a0.cloudfront.net (CloudFront)","x-amz-cf-id":"jCN-HtgXYOAHAOwkM7prZc7mBJYXc0LbO643BSQwZDb2edQ4IolguA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"18","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":161,"createdAt":"2026-01-29T00:06:01.068Z","ttl":1772323561,"ttl_datestamp":"2026-03-01T00:06:01.068Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-bec1b99f-4c61-4338-b5a7-6836d75d35aa","requestId":"6056f89e-2a97-47d7-8e04-2d5f19751dff","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"cc348638-9259-453b-abe6-cca5cab47015","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:05:47.219Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"6056f89e-2a97-47d7-8e04-2d5f19751dff","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"6056f89e-2a97-47d7-8e04-2d5f19751dff"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:47 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"Na3ZF4yDZTRHncVF8nrGEl7wyl0rdlu4xBKipjryES86k7se0Co7jA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"31","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":169,"createdAt":"2026-01-29T00:05:47.439Z","ttl":1772323547,"ttl_datestamp":"2026-03-01T00:05:47.439Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-c24dc2f6-8785-44e3-9b7d-bdb049338781","requestId":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=F","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:00.420Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"134","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:02 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 a8b68315e1e2575143f97748ffbb29a0.cloudfront.net (CloudFront)","x-amz-cf-id":"AA2tIWogSjUV1YYwP81Y3O5lRvytPU2XfqOLejMMTCn23Cb0wWovuA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"2ddb8a23-6bf9-4c9b-9371-f1b93362e3f2","x-envoy-upstream-service-time":"15","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"}]}},"duration":144,"createdAt":"2026-01-29T00:06:02.359Z","ttl":1772323562,"ttl_datestamp":"2026-03-01T00:06:02.359Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-dc027a97-7859-4c4c-8647-3fcb6fb60be3","requestId":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:00.420Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:00 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 a8b68315e1e2575143f97748ffbb29a0.cloudfront.net (CloudFront)","x-amz-cf-id":"fVDP7nd5jqWkYJu8pYJ_aOFooFmHXQv3j-1wzRKNk9ipa4tKE03gww==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"17","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":222,"createdAt":"2026-01-29T00:06:00.710Z","ttl":1772323560,"ttl_datestamp":"2026-03-01T00:06:00.710Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-f4361a1e-aab3-478c-a38a-41872f58e3bf","requestId":"6056f89e-2a97-47d7-8e04-2d5f19751dff","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/obligations?from=2017-01-01&to=2017-03-31&status=O","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"6056f89e-2a97-47d7-8e04-2d5f19751dff","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"6056f89e-2a97-47d7-8e04-2d5f19751dff","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"cc348638-9259-453b-abe6-cca5cab47015","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:05:47.219Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"110","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:05:47 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 e086ec27af2d3105a1a9fa7efa1be454.cloudfront.net (CloudFront)","x-amz-cf-id":"5idYmfoZ6Z6MiQG7zGyJSCWyqKHpkf112Xpvoz-MuSG_GpX_U1O17A==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"1b266102-436e-4e19-a6b3-7bf1a93fd3d1","x-envoy-upstream-service-time":"27","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"O"}]}},"duration":158,"createdAt":"2026-01-29T00:05:47.602Z","ttl":1772323547,"ttl_datestamp":"2026-03-01T00:05:47.602Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-f86c1504-214a-4808-93e7-1e92bc1e5ee7","requestId":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","amznTraceId":null,"traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"05fd035c-8bf7-43ac-913b-6b7c1bf4a4e8","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769645118386","Gov-Client-Public-IP-Timestamp":"2026-01-29T00:06:00.420Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb","traceparent":"00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01","x-correlationid":"4f7f8044-f68b-4b5b-8f1b-11c84c6a60fb"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 00:06:02 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 a8b68315e1e2575143f97748ffbb29a0.cloudfront.net (CloudFront)","x-amz-cf-id":"TbKZaQOJd-nZBi7ByEoFZXASs_424e89h09yXwDERBGixIx7qGxrAA==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"70","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":191,"createdAt":"2026-01-29T00:06:02.210Z","ttl":1772323562,"ttl_datestamp":"2026-03-01T00:06:02.210Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.204Z","msg":"[dynamodb-export]: ── END hmrc-api-requests.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.204Z","msg":"[dynamodb-export]: Exporting table 'test-receipts-table' from endpoint 'http://127.0.0.1:57365' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:13.207Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T00:06:13.203Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.208Z","msg":"[dynamodb-export]: ✅ Exported 1 items from table 'test-receipts-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.208Z","msg":"[dynamodb-export]: ── BEGIN receipts.jsonl ──"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","receiptId":"2026-01-29T00:05:47.882Z-760864409184","receipt":{"processingDate":"2026-01-29T00:05:47.866Z","formBundleNumber":"760864409184","paymentIndicator":"DD","chargeRefNumber":"a8k4ovRD7AWd6EAo"},"createdAt":"2026-01-29T00:05:47.882Z","ttl":1990397147,"ttl_datestamp":"2033-01-27T00:05:47.882Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.208Z","msg":"[dynamodb-export]: ── END receipts.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T00:06:13.208Z","msg":"[dynamodb-export]: ✅ Completed export of all tables"}
[DynamoDB Export]: Export completed: [
  {
    table: [32m'bundles'[39m,
    itemCount: [33m1[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'[39m
  },
  {
    table: [32m'hmrc-api-requests'[39m,
    itemCount: [33m14[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'[39m
  },
  {
    table: [32m'receipts'[39m,
    itemCount: [33m1[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'[39m
  }
]
Asserting HMRC API request exists: POST /oauth/token
[DynamoDB Assertions]: Found 1 OAuth token exchange request(s)
Asserting HMRC API request exists: POST /organisations/vat/965899632/returns
[DynamoDB Assertions]: Found 1 VAT return POST request(s)
Matched all expected values in https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns: { [32m'httpRequest.method'[39m: [32m'POST'[39m, [32m'httpResponse.statusCode'[39m: [33m201[39m }
[DynamoDB Assertions]: VAT POST request body validated - periodKey format: 18A1
Asserting HMRC API request exists: GET /\/organisations\/vat\/965899632\/returns\/\w+/
[DynamoDB Assertions]: Found 1 VAT return GET request(s)
Matched all expected values in https://test-api.service.hmrc.gov.uk/organisations/vat/965899632/returns/18A1: { [32m'httpRequest.method'[39m: [32m'GET'[39m, [32m'httpResponse.statusCode'[39m: [33m200[39m }
[DynamoDB Assertions]: VAT GET response body validated - periodKey format: 18A1
[DynamoDB Assertions]: Found 0 Fraud prevention headers validation feedback GET request(s)
Asserting HMRC API request exists: GET /test/fraud-prevention-headers/validate
[DynamoDB Assertions]: Found 6 Fraud prevention headers validation GET request(s)
[DynamoDB Assertions]: Fraud prevention headers validation GET request #1 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #2 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #3 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #4 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #5 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #6 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
{"level":30,"source":"behaviour-tests/helpers/dynamodb-assertions.js","time":"2026-01-29T00:06:13.249Z","msg":"Found 14 HMRC API requests: OAuth (1) with hashedSub 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0, authenticated (13) with hashedSub 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0"}
[DynamoDB Assertions]: Found 1 unique hashedSub value(s): 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0
[afterEach] Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/userSub.txt for test "Click through: Submit a VAT return to HMRC": user
{"level":30,"source":"app/services/subHasher.js","time":"2026-01-29T00:06:13.351Z","message":"Using USER_SUB_HASH_SALT from environment (local dev/test)"}
[fileHelper] Salt initialized successfully for test diagnostics
[afterEach] Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hashedUserSub.txt for test "Click through: Submit a VAT return to HMRC": 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0
Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/traceparent.txt for test "Click through: Submit a VAT return to HMRC": 00-335b5bfaf814c8754ff312482d671191-fdba94122d040d0a-01
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T00:06:15.617Z","msg":"[proxy]: kill() called on ngrok proxy, stopping..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T00:06:15.617Z","msg":"[ngrok]: Closing tunnel..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T00:06:15.671Z","msg":"[ngrok]: ✅ Tunnel closed"}
  ✓  1 [submitVatBehaviour] › behaviour-tests/submitVat.behaviour.test.js:182:1 › Click through: Submit a VAT return to HMRC (1.1m)

  1 passed (1.3m)

To open last HTML report run:
[36m[39m
[36m  npx playwright show-report target/test-reports/html-report[39m
[36m[39m
