
> @antonycc/web-submit-diyaccounting-co-uk@1.0.0 test:submitVatBehaviour-proxy
> npx dotenv -e .env.proxy -- npm run test:submitVatBehaviour


> @antonycc/web-submit-diyaccounting-co-uk@1.0.0 test:submitVatBehaviour
> playwright test --project=submitVatBehaviour

dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:01.627Z","msg":"Reading CDK configuration from /Users/antony/projects/submit.diyaccounting.co.uk/cdk-application/cdk.json"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:01.627Z","msg":"CDK context:"}
dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.633Z","msg":"envFilePath: .env.proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.633Z","msg":"envName: proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.633Z","msg":"serverPort: 3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.633Z","msg":"runTestServer: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"runProxy: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"runMockOAuth2: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"testAuthProvider: mock"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"testAuthUsername: user"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"testAuthPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"baseUrl: https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"hmrcTestUsername: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"hmrcTestPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"hmrcTestVatNumber: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"runDynamoDb: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"bundleTableName: test-bundle-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"hmrcApiRequestsTableName: test-hmrc-api-requests-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"receiptsTableName: test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:01.634Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}

Running 1 test using 1 worker

dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:02.425Z","msg":"Reading CDK configuration from /Users/antony/projects/submit.diyaccounting.co.uk/cdk-application/cdk.json"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:02.425Z","msg":"CDK context:"}
dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.431Z","msg":"envFilePath: .env.proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.431Z","msg":"envName: proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.431Z","msg":"serverPort: 3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.431Z","msg":"runTestServer: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.432Z","msg":"runProxy: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.432Z","msg":"runMockOAuth2: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.432Z","msg":"testAuthProvider: mock"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.432Z","msg":"testAuthUsername: user"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"testAuthPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"baseUrl: https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"hmrcTestUsername: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"hmrcTestPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"hmrcTestVatNumber: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"runDynamoDb: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"bundleTableName: test-bundle-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.434Z","msg":"hmrcApiRequestsTableName: test-hmrc-api-requests-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.435Z","msg":"receiptsTableName: test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.435Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:02.435Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
Starting beforeAll hook...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:03.067Z","msg":"[dynamodb]: runDynamoDb=run, bundleTableName=test-bundle-table, hmrcApiRequestsTableName=test-hmrc-api-requests-table, receiptsTableName=test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:03.067Z","msg":"[dynamodb]: DYNAMODB_PORT not set; using ephemeral port (0)"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:03.067Z","msg":"[dynamodb]: Starting dynalite (local DynamoDB) server..."}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:03.074Z","msg":"[dynamodb]: Started at http://127.0.0.1:55871"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.074Z","msg":"[dynamodb]: Ensuring bundle table: 'test-bundle-table' exists on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.108Z","msg":"[dynamodb]: ℹ️ Table 'test-bundle-table' not found on endpoint 'http://127.0.0.1:55871', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.115Z","msg":"[dynamodb]: ✅ Created table 'test-bundle-table' on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.115Z","msg":"[dynamodb]: Ensuring HMRC API requests table: 'test-hmrc-api-requests-table' exists on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.121Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-api-requests-table' not found on endpoint 'http://127.0.0.1:55871', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.124Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-api-requests-table' on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.124Z","msg":"[dynamodb]: Ensuring receipts table: 'test-receipts-table' exists on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.129Z","msg":"[dynamodb]: ℹ️ Table 'test-receipts-table' not found on endpoint 'http://127.0.0.1:55871', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.131Z","msg":"[dynamodb]: ✅ Created table 'test-receipts-table' on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.131Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-return-post-async-requests-table' exists on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.135Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-return-post-async-requests-table' not found on endpoint 'http://127.0.0.1:55871', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.137Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-return-post-async-requests-table' on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.137Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-return-get-async-requests-table' exists on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.144Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-return-get-async-requests-table' not found on endpoint 'http://127.0.0.1:55871', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.147Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-return-get-async-requests-table' on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.147Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-obligation-get-async-requests-table' exists on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.152Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-obligation-get-async-requests-table' not found on endpoint 'http://127.0.0.1:55871', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-29T20:31:03.153Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-obligation-get-async-requests-table' on endpoint 'http://127.0.0.1:55871'"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:03.154Z","msg":"[auth]: runMockOAuth2=run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:03.154Z","msg":"[auth]: Starting mock-oauth2-server process..."}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:03.157Z","msg":"[auth]: Checking server readiness for... http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:03.167Z","msg":"[auth]: Starting server at http://localhost:8080/default/debugger after error TypeError: fetch failed"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:03.168Z","msg":"[auth]: Server check attempt 1/15 failed: fetch failed from http://localhost:8080/default/debugger"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:05.171Z","msg":"[auth]: Server check attempt 2/15 failed: fetch failed from http://localhost:8080/default/debugger"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:07.173Z","msg":"[auth]: Server check attempt 3/15 failed: fetch failed from http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:09.335Z","msg":"[auth]: Response body"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:09.335Z","msg":"[auth]: Server is ready! at http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.335Z","msg":"[http]: runTestServer=run, httpServerPort=3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.335Z","msg":"[http]: Starting server process..."}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:09.338Z","msg":"[http]: Checking server readiness for... http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:09.339Z","msg":"[http]: Starting server at http://127.0.0.1:3000 after error TypeError: fetch failed"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:09.340Z","msg":"[http]: Server check attempt 1/15 failed: fetch failed from http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.500Z","msg":"[http-stdout]: dotenvConfigIfNotBlank: Loading environment config from .env"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.513Z","msg":"[http-stdout]: dotenvConfigIfNotBlank: Loading environment config from .env"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.517Z","msg":"[http-stdout]: Mock OAuth routes registered (TEST_AUTH_PROVIDER=mock)"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.521Z","msg":"[http-stdout]: Listening at http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:09.522Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:09.521Z\",\"msg\":\"Listening at http://127.0.0.1:3000\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:10.348Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:10.347Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:10.355Z","msg":"[http]: Response body"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:10.355Z","msg":"[http]: Server is ready! at http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:10.356Z","msg":"[proxy]: runProxy=run, httpServerPort=3000, baseUrl=https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:10.356Z","msg":"[proxy]: Starting ngrok tunnel using @ngrok/ngrok..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T20:31:10.356Z","msg":"[ngrok]: Starting ngrok tunnel for address: 3000, domain: wanted-finally-anteater.ngrok-free.app, pooling: true"}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T20:31:10.855Z","msg":"[ngrok]: ✅ Tunnel established at https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:10.855Z","msg":"[proxy]: Started at https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:10.855Z","msg":"[proxy]: Checking server readiness for... https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:11.074Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:11.074Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-29T20:31:11.128Z","msg":"[proxy]: Server is ready! at https://wanted-finally-anteater.ngrok-free.app"}
beforeAll hook completed successfully
[HMRC Test User] Sandbox mode detected without full credentials - creating test user
[HMRC Test User] Creating HMRC sandbox test user with VAT enrolment using client credentials
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:13.321Z","message":"[HMRC Test User Creation] Starting test user creation","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","serviceNames":["mtd-vat"],"hmrcClientId":"uqMHA6Rs..."}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:13.321Z","message":"[HMRC Test User Creation] Request details (pre-token)","method":"POST","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","body":{"serviceNames":["mtd-vat"]}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:13.321Z","message":"[HMRC Test User Creation] Requesting OAuth2 access token","tokenUrl":"https://test-api.service.hmrc.gov.uk/oauth/token","grantType":"client_credentials"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:13.653Z","message":"[HMRC Test User Creation] Token response received","status":200,"statusText":"OK","hasAccessToken":true}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:13.653Z","message":"[HMRC Test User Creation] Request details (create-test-user)","method":"POST","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"[REDACTED]"},"body":{"serviceNames":["mtd-vat"]}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.302Z","message":"[HMRC Test User Creation] Response received","status":201,"statusText":"Created","responseBody":{"userId":"933271431261","password":"[REDACTED]","userFullName":"Deane Nielsen","emailAddress":"[REDACTED]","organisationDetails":{"name":"Company DUNL8S","address":{"line1":"45 Springfield Rise","line2":"Harrogate","postcode":"TS20 1PA"}},"individualDetails":{"firstName":"Deane","lastName":"Nielsen","dateOfBirth":"1992-06-14","address":{"line1":"40 North End Road","line2":"Fleet","postcode":"TS20 1PA"}},"vatRegistrationDate":"2022-01-29","groupIdentifier":"343514235720","vrn":"749940876"}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.303Z","message":"[HMRC Test User Creation] Test user created successfully","userId":"933271431261","userFullName":"Deane Nielsen","organisationName":"Company DUNL8S"}
[HMRC Test User] Successfully created test user:
  User ID: 933271431261
  User Full Name: Deane Nielsen
  VAT registration number: 749940876
  Organisation: Company DUNL8S
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.303Z","message":"[HMRC Test User] Saving test user details to JSON files","outputDir":"/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour","repoRoot":"/Users/antony/projects/submit.diyaccounting.co.uk"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.304Z","message":"[HMRC Test User] Saved test user to artifact directory","path":"/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-test-user.json"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.304Z","message":"[HMRC Test User] Saved test user to repository root","path":"/Users/antony/projects/submit.diyaccounting.co.uk/hmrc-test-user.json"}
[HMRC Test User] Updated environment variables with generated credentials
Loading document...
[NAVIGATION] (1/4) Going to: https://wanted-finally-anteater.ngrok-free.app/ - Loading home page
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.739Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.739Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.935Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.935Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.937Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.937Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.967Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.967Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.968Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.968Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.969Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.971Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.971Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.972Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.974Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:14.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:14.975Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.093Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.092Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.093Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.093Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.094Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.094Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.095Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.095Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.102Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.101Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.103Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.103Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.103Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.103Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.104Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.104Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.105Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.105Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
[BROWSER CONSOLE log]: User is not authenticated
[BROWSER CONSOLE log]: User is not authenticated
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.200Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.201Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.200Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.202Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.202Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.330Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.330Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Checking home page...
✅ [Compliance] Privacy link visible on home page
✅ [Compliance] Terms link visible on home page
[USER INTERACTION] Clicking: a:has-text('Log in') - Clicking login link
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.885Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.885Z\",\"msg\":\"HTTP GET /auth/login.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.991Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.991Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.991Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.991Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.993Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.993Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.993Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.993Z\",\"msg\":\"HTTP GET /images/g-logo.png\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:15.994Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:15.994Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.007Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.007Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.016Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.016Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.020Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.020Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.021Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.021Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.022Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.022Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.023Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.022Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.023Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.023Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.024Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.024Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.025Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.025Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.122Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.122Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.123Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.123Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.124Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.124Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.125Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.125Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.125Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.125Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.126Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.127Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.127Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.129Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.129Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.131Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.131Z\",\"msg\":\"HTTP GET /auth/login-mock-addon.js\"}"}
[BROWSER CONSOLE error]: Loading the image 'https://avatars.githubusercontent.com/u/11848947?s=48&v=4' violates the following Content Security Policy directive: "img-src 'self' data:". The action has been blocked.
[HTTP REQUEST FAILED] GET https://avatars.githubusercontent.com/u/11848947?s=48&v=4 - csp
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.236Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.235Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.251Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.251Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
Logging in...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.325Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.325Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: button:has-text('Continue with mock-oauth2-server') - Continue with OAuth provider
[BROWSER CONSOLE log]: Initiating navikt/mock-oauth2-server login
[BROWSER CONSOLE log]: Clear stored tokens and user info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.910Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:16.910Z\",\"msg\":\"HTTP GET /api/v1/mock/authUrl?state=f1bfece5d38c733621a47d12079601b2\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:16.912Z\",\"requestId\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/mock/authUrl?state=f1bfece5d38c733621a47d12079601b2\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"cognito:username\":\"test\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/mock/authUrl\"}},\"path\":\"/api/v1/mock/authUrl\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/auth/login.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\"},\"queryStringParameters\":{\"state\":\"f1bfece5d38c733621a47d12079601b2\"},\"rawQueryString\":\"state=f1bfece5d38c733621a47d12079601b2\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/non-lambda-mocks/mockAuthUrlGet.js\",\"time\":\"2026-01-29T20:31:16.912Z\",\"requestId\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"message\":\"Generating mock authorization URL\",\"state\":\"f1bfece5d38c733621a47d12079601b2\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:16.913Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:16.912Z\",\"requestId\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/mock/authUrl?state=f1bfece5d38c733621a47d12079601b2\",\"response\":{\"statusCode\":200,\"headers\":{\"x-request-id\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"956ea6fa-e785-4b1b-9d84-ffbe124b62ea\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"authUrl\\\":\\\"http://localhost:8080/oauth/authorize?response_type=code&client_id=debugger&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Fauth%2FloginWithMockCallback.html&scope=openid%20somescope&state=f1bfece5d38c733621a47d12079601b2&identity_provider=MockOAuth2Server\\\"}\"}}"}
[BROWSER CONSOLE log]: Status message: Handing off to http://localhost:8080/oauth/authorize?response_type=code&client_id=debugger&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Fauth%2FloginWithMockCallback.html&scope=openid%20somescope&state=f1bfece5d38c733621a47d12079601b2&identity_provider=MockOAuth2Server Type: info
[BROWSER CONSOLE log]: Redirecting to navikt/mock-oauth2-server
[USER INTERACTION] Filling: input[name="username"] with value: "user" - Entering username
[USER INTERACTION] Filling: textarea[name="claims"] with value: "{"email":"user@example.com"}" - Entering identity claims
[USER INTERACTION] Clicking: input[type="submit"][value="Sign-in"] - Submitting sign-in form
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:19.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:19.836Z\",\"msg\":\"HTTP GET /auth/loginWithMockCallback.html?code=uY0EkqLzEMZzxvBnl8FIjA9QmYB5pG654D0sPoQ2TOI&state=f1bfece5d38c733621a47d12079601b2\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.030Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.030Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.031Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.031Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.033Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.033Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.051Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.052Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.052Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.053Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.053Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.053Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.053Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.056Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.056Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
[BROWSER CONSOLE log]: Authentication callback received with code: uY0EkqLzEMZzxvBnl8FIjA9QmYB5pG654D0sPoQ2TOI
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.161Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.161Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.161Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.161Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.168Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.168Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.169Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.169Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.169Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.169Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.170Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.170Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.171Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.171Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.173Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.173Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.182Z\",\"msg\":\"HTTP POST /api/v1/mock/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.214Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.214Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.291Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.290Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[BROWSER CONSOLE log]: Received tokens from mock {"token_type":"Bearer","id_token":"eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg","access_token":"eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg","refresh_token":"c4bb277d-7a20-4107-9b7f-9da21374f0a0","expires_in":3599}
[BROWSER CONSOLE log]: Received id_token from mock {"sub":"user","aud":"debugger","nbf":1769718680,"scope":"openid somescope","amr":["mfa","pwd"],"iss":"http://localhost:8080/default","exp":1769722280,"iat":1769718680,"nonce":"5678","jti":"522a87e6-5d96-4561-912f-5d5f3e8fe6cf","email":"user@example.com"}
[BROWSER CONSOLE log]: User authenticated successfully using mock: user@example.com
[BROWSER CONSOLE log]: MFA detected from mock IdP: [mfa, pwd] Stored metadata: {type: OTHER, timestamp: 2026-01-29T20:31:20.425Z, uniqueReference: 29130dc4-040a-4719-859e-daac10d74ddb}
[BROWSER CONSOLE log]: Status message: Authenticated successfully. Fetching bundles... Type: info
[BROWSER CONSOLE log]: Status message: Authenticated successfully. Redirecting... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.470Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.470Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.571Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.571Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.572Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.571Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.574Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.574Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.574Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.574Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.579Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.579Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.580Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.580Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.581Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.581Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.582Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.582Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.583Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.583Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.655Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.655Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.666Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.665Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.678Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.677Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.678Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.678Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.679Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.680Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.680Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.680Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.680Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.681Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.681Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.682Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.771Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.771Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.771Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.771Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.772Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:20.772Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.772Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/subHasher.js\",\"time\":\"2026-01-29T20:31:20.772Z\",\"message\":\"Using USER_SUB_HASH_SALT from environment (local dev/test)\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.773Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:20.772Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.773Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.773Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.773Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:20.773Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.773Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.773Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.773Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.773Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.773Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.773Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.774Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.774Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.776Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.776Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.777Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.777Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.844Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:20.844Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.845Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:20.844Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.845Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.845Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.845Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:20.845Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.846Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.845Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.846Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.846Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.846Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.846Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.846Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.878Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.878Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.886Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.886Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.887Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.886Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.887Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.886Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.887Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:20.887Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.887Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:20.887Z\",\"requestId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"01384ab9-38c1-4aa4-bbae-03673d4fc0ee\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.888Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.888Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.889Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:20.888Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.889Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:20.888Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:20.889Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.889Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:20.889Z\",\"requestId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"89de9fba-423f-4ea5-8eeb-004d34b51b36\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:20.966Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:20.966Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
Checking home page...
[BROWSER CONSOLE log]: [Mock MFA] Injected MFA metadata: {type: TOTP, timestamp: 2026-01-08T00:09:01Z, uniqueReference: test-mfa-1769718682290}
[Mock MFA] Injected: type=TOTP, timestamp=2026-01-08T00:09:01Z, ref=test-mfa-1769718682290
CloudWatch RUM analytics consent dialog is visible, accepting...
[USER INTERACTION] Clicking: button:has-text("Accept") - Accept CloudWatch RUM consent
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
Navigating to Bundles via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Bundles') - Clicking Bundles in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:22.910Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:22.910Z\",\"msg\":\"HTTP GET /account/bundles.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.012Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.010Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.050Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.058Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.058Z\",\"msg\":\"HTTP GET /lib/bundle-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.071Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.096Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.096Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.097Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.097Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.097Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.097Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.098Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.098Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.098Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.099Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.099Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.102Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.102Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.104Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.103Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.149Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.149Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.150Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.149Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.150Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.150Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.162Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.162Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.162Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.162Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.163Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.163Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.164Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.164Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.165Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.165Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.166Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.166Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.195Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.195Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:23.196Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:23.196Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.197Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.196Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:23.197Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.197Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.197Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.197Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.197Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.197Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.197Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.204Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.204Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.205Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:23.205Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:23.205Z\",\"requestId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"correlationId\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"x-correlationid\":\"7d88c2c8-9ca5-4ca2-a421-0d47c1830832\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.241Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.241Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.242Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.242Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.242Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:23.242Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:23.242Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.243Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.242Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.243Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:23.243Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.243Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.243Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.243Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.243Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.243Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.243Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.246Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.246Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.247Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.247Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.247Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:23.247Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:23.247Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:23.247Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.248Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:23.247Z\",\"requestId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"b6d763ef-f936-4f2c-aec1-ab5e88d8b482\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.281Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.281Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.355Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.355Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.380Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:23.380Z\",\"msg\":\"HTTP GET /submit.environment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:23.903Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
Ensuring Test bundle is present...
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (1/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (2/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (3/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (4/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (5/5)
[polling to ensure present]: Test bundle still not present.
Test bundle not present, requesting...
Requesting Test bundle...
[polling be ready to request]: Test bundle request button already visible.
[USER INTERACTION] Clicking: button:has-text('Request Test') - Request Test
[BROWSER CONSOLE log]: Status message: Requesting bundle "Test"... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.190Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.190Z\",\"msg\":\"HTTP POST /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.190Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:30.190Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:30.191Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"35\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"bundleId\\\":\\\"test\\\",\\\"qualifiers\\\":{}}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.191Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Processing bundle request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:30.191Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.191Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Processing bundle request for user\",\"userId\":\"user\",\"bundleId\":\"test\",\"waitTimeMs\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.192Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:30.192Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Executing synchronous processing\",\"userId\":\"user\",\"waitTimeMs\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.192Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.192Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"grantBundle entry\",\"userId\":\"user\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.192Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.192Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.192Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.192Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.196Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.196Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.199Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.199Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Loaded catalog bundle:\",\"bundleId\":\"test\",\"catalogBundle\":{\"id\":\"test\",\"name\":\"Test\",\"allocation\":\"on-request\",\"cap\":10,\"timeout\":\"P1D\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.200Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"[Catalog bundle] Bundle requires manual allocation, proceeding:\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.200Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"[Catalog bundle] Bundle cap not yet reached:\",\"requestedBundle\":\"test\",\"currentCount\":0,\"cap\":10}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.200Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Granting bundle to user:\",\"userId\":\"user\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.200Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"New bundle details:\",\"newBundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.200Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Updated user bundles:\",\"userId\":\"user\",\"currentBundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.201Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.201Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Updating bundles for user user with 1\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.201Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.201Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.201Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.201Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.204Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.204Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.204Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.204Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.204Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.204Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Current bundles for user user in DynamoDB count: 0\",\"currentBundles\":[]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.204Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.204Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Current bundle IDs for user user in DynamoDB count: undefined\",\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.204Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"New bundle IDs for user user count: undefined\",\"newBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.204Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Bundles to remove for user user in DynamoDB\",\"bundlesToRemove\":[]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.205Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Checking if bundle test needs adding for user user in DynamoDB\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.205Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Adding new bundle test for user user in DynamoDB\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.205Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"putBundle [table: test-bundle-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.205Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Storing bundle\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"userId\":\"user\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.205Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.205Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Storing bundle in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"item\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.210Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.210Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Bundle stored in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"item\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.211Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:30.210Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Updated bundles for user user in DynamoDB\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}]}\n{\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-29T20:31:30.210Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Bundle granted to user:\",\"userId\":\"user\",\"newBundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-30\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.211Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:30.211Z\",\"requestId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d1f009fd-0166-4754-8104-97f382f6c3b1\",\"message\":\"Returning result with status 201\"}"}
[BROWSER CONSOLE log]: Status message: Bundle "Test" added successfully. Type: success
[polling to ensure request completed]: Test bundle already present.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.338Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:30.338Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.338Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:30.338Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.339Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.338Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.339Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:30.339Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.339Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.339Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.339Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.339Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.339Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.339Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.339Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.343Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.342Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.343Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.343Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.343Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.343Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:30.343Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.343Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:30.343Z\",\"requestId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"783ffcea-83c4-4abc-a1e8-fe6ec878b9de\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.410Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.411Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.411Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.416Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:30.416Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:30.416Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:30.416Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:30.416Z\",\"requestId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"e02846c2-976b-406a-a7ca-296182f3ddd2\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
Returning to home via home icon...
[USER INTERACTION] Clicking: .home-link - Home icon
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.826Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.826Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.931Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.931Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.933Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.933Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.934Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.933Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.934Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.934Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.935Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.935Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.935Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.935Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.966Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.965Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.967Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.967Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:30.968Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:30.968Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.032Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.032Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.033Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.033Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.035Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.034Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.036Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.036Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.037Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.039Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.038Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.039Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.039Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.040Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.040Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.146Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.146Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.147Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.147Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.148Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.151Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.152Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.152Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:31.152Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:31.152Z\",\"requestId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"fcd8ac8b-fe20-4c47-a705-940a3634606c\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.153Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.153Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.154Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.154Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:31.154Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:31.155Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.155Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:31.155Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.155Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.155Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.155Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.156Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.158Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:31.158Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:31.158Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:31.158Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:31.158Z\",\"requestId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"f3d5a417-0ccc-4981-9fc7-1bdeec38fe25\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.230Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:31.231Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:31.794Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: button:has-text('Submit VAT (HMRC Sandbox)') - Starting VAT return submission
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.605Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.605Z\",\"msg\":\"HTTP GET /hmrc/vat/submitVat.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.711Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.711Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.766Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.766Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.766Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.766Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.795Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.795Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.795Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.795Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.796Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.796Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.796Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.796Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.797Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.797Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.798Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.798Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.798Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.798Z\",\"msg\":\"HTTP GET /lib/utils/obligation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.799Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.799Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.799Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.799Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.911Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.911Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.911Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.911Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.914Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.913Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.914Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.914Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.915Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.915Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.915Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.915Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.916Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.916Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.917Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.917Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.918Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.918Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:32.919Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:32.919Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (no action taken)
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:33.010Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:33.011Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:33.011Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.011Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:33.011Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"cbe5ea6f-5fef-4128-9044-004bea574127\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.012Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.011Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:33.012Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.012Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.012Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.012Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.012Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.012Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.012Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.012Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.012Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.014Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:33.013Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:33.013Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"f913983c-9f06-4c86-b68a-45402a173069\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.013Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:33.014Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.014Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.014Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.014Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.014Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.016Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.016Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.016Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.016Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.016Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.016Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:33.016Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.017Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:33.016Z\",\"requestId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"cbe5ea6f-5fef-4128-9044-004bea574127\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.019Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:33.018Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.020Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.019Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.020Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:33.020Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:33.020Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:33.020Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:33.020Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:33.020Z\",\"requestId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"f913983c-9f06-4c86-b68a-45402a173069\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:34.239Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Filling: #vatNumber with value: "749940876" - Entering VAT number
Set period dates: 2017-01-01 to 2017-03-31
[USER INTERACTION] Filling: #vatDueSales with value: "1000.00" - Entering VAT due on sales (Box 1)
[USER INTERACTION] Filling: #vatDueAcquisitions with value: "0.00" - Entering VAT due on acquisitions (Box 2)
[USER INTERACTION] Filling: #vatReclaimedCurrPeriod with value: "0.00" - Entering VAT reclaimed (Box 4)
[USER INTERACTION] Filling: #totalValueSalesExVAT with value: "5000" - Entering total sales ex VAT (Box 6)
[USER INTERACTION] Filling: #totalValuePurchasesExVAT with value: "0" - Entering total purchases ex VAT (Box 7)
[USER INTERACTION] Filling: #totalValueGoodsSuppliedExVAT with value: "0" - Entering goods supplied to EU (Box 8)
[USER INTERACTION] Filling: #totalAcquisitionsExVAT with value: "0" - Entering acquisitions from EU (Box 9)
Checked declaration checkbox
Enabled developer mode for test scenario
Developer section visible (controlled by global developer mode)
Checked runFraudPreventionHeaderValidation checkbox
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:37.255Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
Checked allowSandboxObligations checkbox
[USER INTERACTION] Focusing: #submitBtn - the Submit button
[USER INTERACTION] Clicking: #submitBtn - Submitting VAT form
[BROWSER CONSOLE log]: Status message: Initiating HMRC authentication... Type: info
[BROWSER CONSOLE log]: Stored pending request and current activity: {"vatNumber":"749940876","periodStart":"2017-01-01","periodEnd":"2017-03-31","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":5000,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0,"finalised":true,"testScenario":"","runFraudPreventionHeaderValidation":true,"allowSandboxObligations":true} /hmrc/vat/submitVat.html sandbox
[BROWSER CONSOLE log]: Using client-side generated HMRC Auth URL: https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=692d496292bc4c27bffaec74bf478724
[BROWSER CONSOLE log]: Current activity set to: /hmrc/vat/submitVat.html
[BROWSER CONSOLE log]: Status message: Redirecting to HMRC for authentication at https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=692d496292bc4c27bffaec74bf478724... Type: info
[BROWSER CONSOLE log]: Page transition initiated: Redirecting to HMRC OAuth URL https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=692d496292bc4c27bffaec74bf478724
[USER INTERACTION] Clicking: Continue button - Continuing with HMRC permission
[USER INTERACTION] Clicking: [Locator] - Continue
[USER INTERACTION] Clicking: Sign in to HMRC button - Starting HMRC authentication
[USER INTERACTION] Clicking: [Locator] - Sign in to the HMRC online service
[BROWSER ERROR]: Cannot read properties of null (reading 'addEventListener')
[BROWSER ERROR]: Cannot read properties of undefined (reading 'initAll')
[USER INTERACTION] Filling: #userId with value: "933271431261" - Entering HMRC user ID
[USER INTERACTION] Filling: #password with value: "ANSEP6Y6KIu8" - Entering HMRC password
[USER INTERACTION] Clicking: Sign in button - Submitting HMRC credentials
[USER INTERACTION] Clicking: [Locator] - Sign in
[USER INTERACTION] Clicking: #givePermission - Give permission
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.395Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.395Z\",\"msg\":\"HTTP GET /activities/submitVatCallback.html?code=97d9d982839448b8929de994628f0a59&state=692d496292bc4c27bffaec74bf478724\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.616Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.615Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.617Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.617Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.646Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.646Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.648Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.647Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.648Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.648Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.649Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.649Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.650Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.650Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.651Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.651Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.776Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.776Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.776Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.776Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.777Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.777Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.787Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.787Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.793Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.793Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.793Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.793Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.794Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.794Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.794Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.794Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.795Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.795Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: OAuth callback handler
[BROWSER CONSOLE log]: Page transition initiated: Clearing URL parameters
[BROWSER CONSOLE log]: OAuth callback handler (normal completion)
[BROWSER CONSOLE log]: Status message: Exchanging authorization code for access token... Type: info
[BROWSER CONSOLE log]: Exchanging token. Remote call initiated: POST /api/v1/hmrc/token ++ Body: {"code":"97d9d982839448b8929de994628f0a59"}
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.893Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.893Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.894Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.894Z\",\"msg\":\"HTTP POST /api/v1/hmrc/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.894Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:48.894Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.895Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:48.894Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/token\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/token\"}},\"path\":\"/api/v1/hmrc/token\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"43\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"code\\\":\\\"97d9d982839448b8929de994628f0a59\\\"}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.895Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-29T20:31:48.895Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"Exchanging authorization code for HMRC access token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.895Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-29T20:31:48.895Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"msg\":\"Retrieving HMRC client secret from arn \"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.895Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-29T20:31:48.895Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"msg\":\"Secret retrieved from override and cached\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.896Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:48.895Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/oauth/token\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"headers\":{\"Content-Type\":\"application/x-www-form-urlencoded\",\"x-request-id\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\"},\"body\":\"grant_type=authorization_code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&client_secret=a2dd6f2e-c7e0-4d3c-aeb2-0506b9c35f56&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&code=97d9d982839448b8929de994628f0a59\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.896Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:48.895Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"Performing HTTP POST for token exchange\",\"providerUrl\":\"https://test-api.service.hmrc.gov.uk/oauth/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.935Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:48.935Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.936Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:48.936Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.939Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:48.939Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.940Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:48.939Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:48.939Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:48.940Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:48.940Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:48.940Z\",\"requestId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8589b745-3020-4beb-abf3-d3e04d7798b6\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.155Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"HTTP POST response received with status and duration\",\"status\":200,\"duration\":259}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.156Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.160Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.160Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.160Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.160Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"exchangeClientSecretForAccessToken response\",\"responseStatus\":200,\"responseTokens\":{\"access_token\":\"[REDACTED]\",\"refresh_token\":\"[REDACTED]\",\"expires_in\":14400,\"scope\":\"write:vat read:vat\",\"token_type\":\"bearer\"},\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"tokenType\":\"bearer\",\"scope\":\"write:vat read:vat\",\"expiresIn\":14400,\"hasRefreshToken\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.160Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.160Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"Token exchange succeeded\",\"accessTokenLength\":32,\"hasIdToken\":false,\"hasRefreshToken\":true,\"expiresIn\":14400,\"tokenType\":\"bearer\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.160Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.160Z\",\"requestId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/token\",\"response\":{\"statusCode\":200,\"headers\":{\"x-request-id\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"bdabd5e6-dd10-4723-8753-580ef2bcee53\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"accessToken\\\":\\\"16ce474dee1d23f5c911721b41d83165\\\",\\\"hmrcAccessToken\\\":\\\"16ce474dee1d23f5c911721b41d83165\\\",\\\"refreshToken\\\":\\\"80b0a42f99aa46b90fc33db9e0164295\\\",\\\"expiresIn\\\":14400,\\\"tokenType\\\":\\\"bearer\\\"}\"}}"}
[BROWSER CONSOLE log]: Exchanged token. Remote call completed successfully: POST /api/v1/hmrc/token {accessToken: 16ce474dee1d23f5c911721b41d83165, hmrcAccessToken: 16ce474dee1d23f5c911721b41d83165, refreshToken: 80b0a42f99aa46b90fc33db9e0164295, expiresIn: 14400, tokenType: bearer} 16ce474dee1d23f5c911721b41d83165
[BROWSER CONSOLE log]: Status message: Obtained Access Token from HMRC... Type: info
[BROWSER CONSOLE log]: Current activity found: /hmrc/vat/submitVat.html
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.251Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.251Z\",\"msg\":\"HTTP GET /hmrc/vat/submitVat.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.351Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.351Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.351Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.351Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.353Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.353Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.354Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.354Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.355Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.354Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.366Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.366Z\",\"msg\":\"HTTP GET /lib/utils/obligation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.370Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.370Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.370Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.370Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.377Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.377Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.378Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.378Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.378Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.378Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.446Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.445Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.451Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.451Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.459Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.458Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.465Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.465Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.466Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.466Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.467Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.467Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.467Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.467Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.468Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.468Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.469Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.469Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.471Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.471Z\",\"msg\":\"HTTP GET /submit.env\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: Restored form draft from 2026-01-29T20:31:36.669Z
[BROWSER CONSOLE log]: OAuth callback handler (code present, auto-continue)
[BROWSER CONSOLE log]: Retrieved submission data: {vatNumber: 749940876, periodStart: 2017-01-01, periodEnd: 2017-03-31, vatDueSales: 1000, vatDueAcquisitions: 0}
[BROWSER CONSOLE log]: Status message: Submitting VAT return to HMRC... Type: info
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.558Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.557Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.558Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.558Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.558Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:49.558Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.558Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.558Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"73d58fc1-80cb-45e0-b820-8265663025a9\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.559Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.558Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.559Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:49.558Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.559Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.559Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.559Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.559Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.559Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.559Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.559Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.559Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.561Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.560Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.561Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.562Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.561Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.563Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.563Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.564Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.563Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.564Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.563Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:49.564Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.564Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.564Z\",\"requestId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"73d58fc1-80cb-45e0-b820-8265663025a9\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.565Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.565Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.565Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.565Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.566Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:49.565Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:49.565Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.566Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.566Z\",\"requestId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"24f9968b-5945-42dc-bab3-1577bfc0a6bb\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
[BROWSER CONSOLE log]: Submitting VAT. Remote call initiated: POST /api/v1/hmrc/vat/return ++ Body: {"vatNumber":"749940876","periodStart":"2017-01-01","periodEnd":"2017-03-31","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":5000,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0,"finalised":true,"accessToken":"16ce474dee1d23f5c911721b41d83165","runFraudPreventionHeaderValidation":true}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.632Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:49.632Z\",\"msg\":\"HTTP POST /api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.632Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:49.632Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.633Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.633Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:31:49.588Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"e95d6d99-f1fb-4dab-992d-591676c9fc6e\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"749940876\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"16ce474dee1d23f5c911721b41d83165\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.633Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.633Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.633Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.633Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.633Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.633Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.634Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.633Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:31:49.588Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"e95d6d99-f1fb-4dab-992d-591676c9fc6e\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"749940876\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"16ce474dee1d23f5c911721b41d83165\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.635Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.635Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.635Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.635Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.635Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.635Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.638Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.638Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.638Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:49.638Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.638Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.638Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.638Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.638Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.639Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:49.638Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.640Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.640Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"16ce474d...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.640Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:49.640Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Checking for test scenario\":null}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.640Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:49.640Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vatNumber\":\"749940876\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.640Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:31:49.640Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.640Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.640Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.805Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.805Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.805Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.805Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.805Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.805Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.805Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.808Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.808Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.809Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.809Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:31:49.588Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.970Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.970Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.970Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.970Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.973Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:49.973Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:49.973Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.973Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:49.973Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:49.973Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.974Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:49.974Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:49.975Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Validating fraud prevention headers for sandbox account\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:49.975Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.976Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:49.976Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.976Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.976Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.983Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.983Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.983Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:49.983Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.984Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:49.983Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:49.984Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:49.984Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:31:49.588Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Retry-After\":\"5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [POST /api/v1/hmrc/vat/return] (timeout: 1630000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... (poll #1) Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:50.122Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.123Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:50.122Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:50.122Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.123Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:50.123Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:50.126Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:50.126Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:31:49.588Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"body\":{\"periodKey\":\"18A1\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":5000,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0,\"finalised\":true},\"environment\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.127Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:50.127Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"method\":\"POST\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:31:49.588Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"body\":\"{\\\"periodKey\\\":\\\"18A1\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true}\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.329Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:50.329Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Response from POST https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"status\":201,\"hmrcResponseBody\":{\"processingDate\":\"2026-01-29T20:31:50.307Z\",\"formBundleNumber\":\"034899331243\",\"paymentIndicator\":\"DD\",\"chargeRefNumber\":\"unDzc87fo6opxqky\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.329Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:50.329Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.333Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:50.333Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.333Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:50.333Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Received HMRC response: {}\",\"httpResult\":{\"hmrcResponse\":{},\"hmrcResponseBody\":{\"processingDate\":\"2026-01-29T20:31:50.307Z\",\"formBundleNumber\":\"034899331243\",\"paymentIndicator\":\"DD\",\"chargeRefNumber\":\"unDzc87fo6opxqky\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.334Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:50.333Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putReceipt [table: test-receipts-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.334Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:50.334Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Storing receipt\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"userSub\":\"user\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.334Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:50.334Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Storing receipt in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\",\"ttl_datestamp\":\"2033-01-27T20:31:50.334Z\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.336Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:50.336Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Receipt stored in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.336Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:50.336Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.336Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:50.336Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.336Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:50.336Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:50.339Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:50.339Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [POST /api/v1/hmrc/vat/return] (poll #1, elapsed: 1000ms, timeout: 1630000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.077Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:51.077Z\",\"msg\":\"HTTP POST /api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.077Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:51.077Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.078Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:51.078Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:31:49.588Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"e95d6d99-f1fb-4dab-992d-591676c9fc6e\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"749940876\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"16ce474dee1d23f5c911721b41d83165\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.078Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.078Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.078Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.078Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:51.078Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"407\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:31:49.588Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"e95d6d99-f1fb-4dab-992d-591676c9fc6e\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"749940876\\\",\\\"periodStart\\\":\\\"2017-01-01\\\",\\\"periodEnd\\\":\\\"2017-03-31\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true,\\\"accessToken\\\":\\\"16ce474dee1d23f5c911721b41d83165\\\",\\\"runFraudPreventionHeaderValidation\\\":true}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.080Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.080Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.080Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:51.080Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.080Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:51.080Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.083Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:51.083Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.083Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:51.083Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.083Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.083Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.083Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:51.083Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.084Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"16ce474d...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:51.084Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Checking for test scenario\":null}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:51.084Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vatNumber\":\"749940876\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:31:51.084Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.084Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.200Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.201Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.200Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.200Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.201Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:51.201Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.203Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:51.203Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.203Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.203Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:31:49.588Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.347Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:31:51.347Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.347Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:51.347Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.350Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:31:51.349Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.350Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:51.350Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.350Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:51.350Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:31:51.353Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:51.353Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-29T20:31:51.353Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Found persisted request\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:51.353Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:51.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:51.353Z\",\"requestId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"476876a9-9ff5-4faa-8e05-2cea4210309d\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:31:49.588Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"8a6a2334-35ba-4eb0-a029-c99ebcf439bc\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"receipt\\\":{\\\"processingDate\\\":\\\"2026-01-29T20:31:50.307Z\\\",\\\"formBundleNumber\\\":\\\"034899331243\\\",\\\"paymentIndicator\\\":\\\"DD\\\",\\\"chargeRefNumber\\\":\\\"unDzc87fo6opxqky\\\"},\\\"hmrcResponse\\\":{\\\"ok\\\":true,\\\"status\\\":201,\\\"statusText\\\":\\\"Created\\\",\\\"headers\\\":{\\\"cache-control\\\":\\\"no-cache,no-store,max-age=0\\\",\\\"connection\\\":\\\"keep-alive\\\",\\\"content-length\\\":\\\"140\\\",\\\"content-security-policy\\\":\\\"default-src 'self'\\\",\\\"content-type\\\":\\\"application/json\\\",\\\"date\\\":\\\"Thu, 29 Jan 2026 20:31:50 GMT\\\",\\\"receipt-id\\\":\\\"87c53d0b-b52c-4019-a0b0-e67b7fd2ce14\\\",\\\"receipt-signature\\\":\\\"This has been deprecated - DO NOT USE\\\",\\\"receipt-timestamp\\\":\\\"2026-01-29T20:31:50Z\\\",\\\"strict-transport-security\\\":\\\"max-age=31536000;\\\",\\\"vary\\\":\\\"Origin\\\",\\\"via\\\":\\\"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)\\\",\\\"x-amz-cf-id\\\":\\\"YmNdAX7U8lXrW7rtezj1hoWAzWPHOECmYsWpaxOGGiK7Pqpkm1Dn3g==\\\",\\\"x-amz-cf-pop\\\":\\\"AMS1-P1\\\",\\\"x-cache\\\":\\\"Miss from cloudfront\\\",\\\"x-content-type-options\\\":\\\"nosniff, nosniff\\\",\\\"x-correlationid\\\":\\\"87c53d0b-b52c-4019-a0b0-e67b7fd2ce14\\\",\\\"x-envoy-upstream-service-time\\\":\\\"44\\\",\\\"x-frame-options\\\":\\\"SAMEORIGIN\\\"}},\\\"hmrcResponseBody\\\":{\\\"processingDate\\\":\\\"2026-01-29T20:31:50.307Z\\\",\\\"formBundleNumber\\\":\\\"034899331243\\\",\\\"paymentIndicator\\\":\\\"DD\\\",\\\"chargeRefNumber\\\":\\\"unDzc87fo6opxqky\\\"},\\\"periodKey\\\":\\\"18A1\\\",\\\"receiptId\\\":\\\"2026-01-29T20:31:50.333Z-034899331243\\\"}\"}}"}
[BROWSER CONSOLE log]: finished async request [POST /api/v1/hmrc/vat/return] (poll #1, elapsed: 1379ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT return processed Type: success
[BROWSER CONSOLE log]: Page display transition: Displaying receipt and hiding form {receipt: Object, hmrcResponse: Object, hmrcResponseBody: Object, periodKey: 18A1, receiptId: 2026-01-29T20:31:50.333Z-034899331243}
[BROWSER CONSOLE log]: Continue submission handler (success, session storage cleared)
[Test] Captured resolved periodKey from response: 18A1
Waiting for VAT submission to complete and receipt to be displayed...
Current URL: https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox
Page title: Submit VAT Return - DIY Accounting
Body element exists: true
Main content element exists: true
Receipt element exists: true
Receipt element style: display: block;
Form element exists: true
Form element style: display: none;
Receipt element visible: true
formBundleNumber validated: 034899331243
chargeRefNumber validated: unDzc87fo6opxqky
processingDate validated: 29 January 2026 at 21:31 (parsed as 2026-01-29T20:31:00.000Z)
VAT submission flow completed successfully with validated receipt fields
Navigating to Receipts via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Receipts') - Clicking Receipts in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.071Z\",\"msg\":\"HTTP GET /hmrc/receipt/receipts.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.155Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.198Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.198Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.203Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.203Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.224Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.223Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.227Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.226Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.227Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.227Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.227Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.227Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.228Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.228Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.229Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.229Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.284Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.283Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.304Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.304Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.304Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.304Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.307Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.307Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.308Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.308Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.308Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.308Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.309Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.309Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.309Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.309Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.310Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.310Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.413Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.414Z\",\"msg\":\"HTTP GET /api/v1/hmrc/receipt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:54.414Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.414Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.415Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:54.415Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.415Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.415Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.415Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.415Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.415Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.417Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:54.416Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.416Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt\"}},\"path\":\"/api/v1/hmrc/receipt\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.416Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.416Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.417Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.416Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.417Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.417Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt\"}},\"path\":\"/api/v1/hmrc/receipt\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.418Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.417Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.418Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.418Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.418Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.418Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.419Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.419Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.419Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.419Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.420Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.419Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:54.420Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.420Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.420Z\",\"requestId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"1624417b-5c88-40a0-bdc1-c30ac49469b3\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.420Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.420Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.420Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.420Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.421Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt\",\"requiredBundleIds\":[\"default\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:54.421Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcReceiptGet.js\",\"time\":\"2026-01-29T20:31:54.421Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Listing user receipts\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:54.421Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"DynamoDB enabled, proceeding with listUserReceipts [table: test-receipts-table]\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.421Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:54.421Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Retrieving receipts from DynamoDB\",\"userSub\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.423Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.422Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.423Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:54.423Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Queried DynamoDB for user receipts\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.424Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:54.424Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Retrieved receipts from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.424Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.424Z\",\"requestId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"4f03f2bd-ed17-4ca2-9937-49873ce08730\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"receipts\\\":[{\\\"receiptId\\\":\\\"2026-01-29T20:31:50.333Z-034899331243\\\",\\\"key\\\":\\\"receipts/user/2026-01-29T20:31:50.333Z-034899331243.json\\\",\\\"name\\\":\\\"2026-01-29T20:31:50.333Z-034899331243.json\\\",\\\"timestamp\\\":\\\"2026-01-29T20:31:50.333Z\\\",\\\"formBundleNumber\\\":\\\"034899331243\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:50.334Z\\\",\\\"lastModified\\\":\\\"2026-01-29T20:31:50.334Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.424Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.424Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.425Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:54.425Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.425Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.425Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.425Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.425Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.425Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:54.425Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.425Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.426Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.425Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.426Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.426Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.426Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.426Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.427Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.427Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.428Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.428Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.428Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:54.428Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.428Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:54.428Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:54.428Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.428Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:54.428Z\",\"requestId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"09567eb4-ae7c-45cb-8cc8-83298dcbbf01\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:54.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:54.526Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Checking receipts page...
Found receipts, clicking on first receipt...
[USER INTERACTION] Clicking: [Locator] - Open first receipt
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.111Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:56.110Z\",\"msg\":\"HTTP GET /api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.111Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:56.111Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.111Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:56.111Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\"}},\"path\":\"/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{\"name\":\"2026-01-29T20:31:50.333Z-034899331243.json\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.111Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.111Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.111Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.111Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.111Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.111Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.112Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:56.111Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\"}},\"path\":\"/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{\"name\":\"2026-01-29T20:31:50.333Z-034899331243.json\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.112Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.112Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.112Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:56.112Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.112Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:56.112Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:56.114Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:56.114Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.115Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.115Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\",\"requiredBundleIds\":[\"default\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:31:56.115Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt/2026-01-29T20%3A31%3A50.333Z-034899331243.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcReceiptGet.js\",\"time\":\"2026-01-29T20:31:56.115Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Retrieving single receipt\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\",\"key\":\"receipts/user/2026-01-29T20:31:50.333Z-034899331243.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:56.115Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"DynamoDB enabled, proceeding with getReceipt [table: test-receipts-table]\",\"userSub\":\"user\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:56.115Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Retrieving receipt from DynamoDB\",\"userSub\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:56.117Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-29T20:31:56.117Z\",\"requestId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"3653e6d5-9edb-4895-b20d-9b14006358a4\",\"message\":\"Retrieved receipt from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-29T20:31:50.333Z-034899331243\"}"}
Returning to home via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Activities') - Clicking Activities in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.006Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.006Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.112Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.111Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.154Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.154Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.155Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.185Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.185Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.187Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.194Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.194Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.196Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.196Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.196Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.197Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.197Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.281Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.281Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.286Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.286Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.293Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.293Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.294Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.294Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.294Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.295Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.295Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.296Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.296Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.296Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.296Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.297Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.409Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.408Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.409Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.409Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.409Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:57.409Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.409Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:57.409Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"aaf301fa-511a-4123-8e42-952047596545\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.410Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.409Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.410Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:57.409Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.410Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.410Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.410Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.410Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.410Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.410Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.411Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.412Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.412Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.412Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:57.412Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:57.412Z\",\"requestId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aaf301fa-511a-4123-8e42-952047596545\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"aaf301fa-511a-4123-8e42-952047596545\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"aaf301fa-511a-4123-8e42-952047596545\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.413Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:57.413Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:57.413Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.414Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:57.414Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.414Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.414Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.414Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.414Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.414Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.416Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:57.416Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:57.416Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:57.416Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.416Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:57.416Z\",\"requestId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"cfdcc392-02f3-4f20-8834-f948b7e29da5\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.484Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.526Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:57.531Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:57.531Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: button:has-text('View VAT Return (HMRC Sandbox)') - Starting View VAT Return
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.286Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.286Z\",\"msg\":\"HTTP GET /hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.399Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.398Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.401Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.401Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.402Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.402Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.426Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.426Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.460Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.460Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.461Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.461Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.462Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.462Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.464Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.463Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.464Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.464Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.465Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.465Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.466Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.466Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.554Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.554Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.567Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.567Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.573Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.573Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.575Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.575Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.576Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.576Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.576Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.576Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.578Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.578Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.578Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.578Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.579Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.579Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.579Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.579Z\",\"msg\":\"HTTP GET /submit.env\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (accessToken found)
[BROWSER CONSOLE log]: No pending return request found
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.671Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.671Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.671Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.671Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.672Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.672Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.676Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.675Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.676Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.676Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.676Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.676Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:58.676Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.676Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:58.676Z\",\"requestId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"dbb128ab-1fe7-4d87-a46e-49c6cd2ba239\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.678Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:31:58.678Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.679Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.682Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:31:58.682Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:31:58.682Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:31:58.682Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:58.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:31:58.682Z\",\"requestId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"c9103a30-2703-41c8-8fa8-ea5a595a6349\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:31:59.879Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated view VAT return form with test data
[USER INTERACTION] Filling: #vrn with value: "749940876" - Entering VAT registration number
Set period dates: 2017-01-01 to 2017-03-31
Enabled developer mode for test scenario
Developer section visible (controlled by global developer mode)
Checked runFraudPreventionHeaderValidation checkbox
[USER INTERACTION] Focusing: #retrieveBtn - Retrieve button
[USER INTERACTION] Clicking: #retrieveBtn - Submitting view VAT return form
[BROWSER CONSOLE log]: Status message: Retrieving VAT return... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:02.683Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:02.684Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.685Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:02.685Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:02.601Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"5b506023-14fc-40b6-ab0b-0d003169c78a\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.685Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.685Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.685Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.685Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.685Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.685Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:02.685Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:02.601Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"5b506023-14fc-40b6-ab0b-0d003169c78a\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.686Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.686Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.686Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:02.686Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:02.686Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.688Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:02.688Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.688Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:02.688Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.688Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.688Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.688Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.689Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:02.688Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.689Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:02.689Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"16ce474d...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.689Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:02.689Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.689Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:02.689Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vrn\":\"749940876\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.689Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:02.689Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.689Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:02.689Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.896Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:02.896Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.896Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:02.896Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:02.896Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.896Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:02.896Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.899Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:02.899Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:02.899Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:02.899Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:02.601Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.067Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.067Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.067Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.067Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:03.070Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:03.071Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Validating fraud prevention headers for sandbox account\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.071Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:03.071Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.071Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.074Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.074Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.075Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:03.075Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:03.075Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:02.601Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"Retry-After\":\"5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [GET /api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true] (timeout: 730000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.222Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.222Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.222Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.222Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.222Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}\n{\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.222Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.225Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.225Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.225Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.225Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:02.601Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.453Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:03.453Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1\",\"status\":200,\"hmrcResponseBody\":{\"periodKey\":\"18A1\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":5000,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.453Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.453Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.456Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.456Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.456Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:03.456Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.456Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:03.456Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-return-get-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.456Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:03.458Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:03.458Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [GET /api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true] (poll #1, elapsed: 1001ms, timeout: 730000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.151Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:04.151Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.151Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:04.151Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:04.151Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:02.601Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"5b506023-14fc-40b6-ab0b-0d003169c78a\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.152Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.152Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.152Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:04.152Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:02.601Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"5b506023-14fc-40b6-ab0b-0d003169c78a\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"runFraudPreventionHeaderValidation\":\"true\",\"allowSandboxObligations\":\"true\"},\"rawQueryString\":\"vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.153Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:04.153Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:04.153Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"16ce474d...\",\"isValidFormat\":true}}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Resolving periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"vrn\":\"749940876\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"msg\":\"Validating fraud prevention headers for HMRC API request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:04.155Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Multi-Factor\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.683Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:04.683Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.684Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:04.683Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:04.684Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:04.684Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.686Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:04.686Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:04.686Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:04.686Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:02.601Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.216Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:05.216Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.216Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:05.216Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.218Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:05.218Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.219Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:05.218Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Resolved periodKey from date range\",\"periodStart\":\"2017-01-01\",\"periodEnd\":\"2017-03-31\",\"resolvedPeriodKey\":\"18A1\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.219Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:05.219Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.220Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:05.220Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.221Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:05.220Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-29T20:32:05.220Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Found persisted request\",\"status\":\"completed\"}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:05.220Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:05.221Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:05.221Z\",\"requestId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"8ded02cf-27a9-4956-a0b5-92c7254e8fce\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:02.601Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"1e360d62-4589-4ea4-a7f0-8ebfcccdb252\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"periodKey\\\":\\\"18A1\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":5000,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0}\"}}"}
[BROWSER CONSOLE log]: finished async request [GET /api/v1/hmrc/vat/return?vrn=749940876&periodStart=2017-01-01&periodEnd=2017-03-31&runFraudPreventionHeaderValidation=true&allowSandboxObligations=true] (poll #1, elapsed: 2138ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT return retrieved. Type: success
[BROWSER CONSOLE log]: Hiding all status messages
VAT due on sales validated: £1000.00
VAT due on acquisitions validated: £0.00
Total VAT due validated: £1000.00
VAT reclaimed on purchases validated: £0.00
View VAT return completed successfully with validated fields
Returning to home via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Activities') - Clicking Activities in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.492Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.491Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.584Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.583Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.610Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.610Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.645Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.644Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.646Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.646Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.647Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.647Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.647Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.647Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.648Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.648Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.649Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.649Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.650Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.650Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.724Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.724Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.725Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.725Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.726Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.726Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.727Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.727Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.727Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.727Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.728Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.728Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.729Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.728Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.729Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.729Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.835Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.835Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.835Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.835Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:06.835Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.836Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.836Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.838Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.837Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.839Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.838Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.839Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.838Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.839Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.839Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:06.839Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.839Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:06.839Z\",\"requestId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"aea2c2f0-1780-4122-89ef-6c8b77469043\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.839Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.839Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.839Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:06.839Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.840Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:06.839Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:06.840Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.840Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:06.840Z\",\"requestId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"a844d7f5-4c9d-41be-bf84-1970d03f307d\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.840Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.840Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.841Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.840Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.908Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.952Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.952Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:06.952Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:06.952Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[USER INTERACTION] Clicking: button:has-text('VAT Obligations (HMRC Sandbox)') - Starting VAT Obligations
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.706Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.706Z\",\"msg\":\"HTTP GET /hmrc/vat/vatObligations.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.798Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.796Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.826Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.826Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.830Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.830Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.846Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.846Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.848Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.848Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.870Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.869Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.870Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.870Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.871Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.871Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.872Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.872Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.873Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.873Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.874Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.874Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.946Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.946Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.951Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.951Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.963Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.963Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.969Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.970Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.970Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.970Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.970Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.970Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.970Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.971Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.971Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.972Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.972Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:07.972Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:07.972Z\",\"msg\":\"HTTP GET /submit.env\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (accessToken found)
[BROWSER CONSOLE log]: No pending obligations request found
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:08.071Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:08.071Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.071Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:08.071Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.071Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:08.071Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.072Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.072Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.072Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.072Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.074Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:08.073Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.075Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.075Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.075Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:08.075Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.075Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:08.075Z\",\"requestId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"2d582784-8e2c-4e21-8d42-509f2f29e3c5\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"bb52e240-e944-41f6-837b-0a373e4520b3\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.076Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.077Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.076Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.077Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.077Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.078Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:08.079Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:08.079Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:08.079Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:08.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:08.079Z\",\"requestId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"bb52e240-e944-41f6-837b-0a373e4520b3\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:09.380Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated VAT obligations form with test data
[USER INTERACTION] Filling: #vrn with value: "749940876" - Entering VAT registration number
[USER INTERACTION] Filling: #fromDate with value: "2025-01-01" - Entering from date
[USER INTERACTION] Filling: #toDate with value: "2025-12-01" - Entering to date
[USER INTERACTION] Focusing: #status - the obligations status filter
[USER INTERACTION] Focusing: #retrieveBtn - Retrieve button
[USER INTERACTION] Clicking: #retrieveBtn - Submitting VAT obligations form
[BROWSER CONSOLE log]: Status message: Retrieving VAT obligations... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.576Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:12.576Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.576Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:12.576Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.577Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:12.577Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:12.481Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"f7e11f35-4a80-4a40-af3d-03b67ecfa05b\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=749940876&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.577Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.577Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.577Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.577Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.577Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.577Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:12.577Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:12.481Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"f7e11f35-4a80-4a40-af3d-03b67ecfa05b\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=749940876&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.578Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.578Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.578Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:12.578Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.578Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:12.578Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.580Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:12.580Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.580Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:12.580Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.580Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.581Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.580Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.581Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.581Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"16ce474d...\",\"isValidFormat\":true}}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.581Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.581Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.582Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.581Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.582Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:12.582Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.582Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:12.582Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Skipping fraud prevention header validation for HMRC API request\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":false}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.582Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:12.582Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"[REDACTED]\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:12.481Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.584Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:12.584Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.584Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.584Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.587Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.587Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"AsyncRequest not found in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.587Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:12.587Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.587Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:12.587Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:12.481Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"Retry-After\":\"5\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.588Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.588Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: waiting async request [GET /api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01] (timeout: 730000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.907Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:12.907Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"},{\"periodKey\":\"18A2\",\"start\":\"2017-04-01\",\"end\":\"2017-06-30\",\"due\":\"2017-08-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.907Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.907Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.909Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.909Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.910Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:12.910Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.910Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:12.910Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.910Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.910Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:12.912Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:12.912Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [GET /api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01] (poll #1, elapsed: 1001ms, timeout: 730000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.711Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:13.711Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:13.711Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:13.712Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:12.481Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"f7e11f35-4a80-4a40-af3d-03b67ecfa05b\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=749940876&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.712Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.712Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.712Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:13.712Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"f149b7ff-afaf-488f-ba8e-89899fc0bba0\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 16ce474dee1d23f5c911721b41d83165\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"gov-client-multi-factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"gov-client-public-ip\":\"178.231.187.149\",\"gov-client-public-ip-timestamp\":\"2026-01-29T20:32:12.481Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+01:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiZjE0OWI3ZmYtYWZhZi00ODhmLWJhOGUtODk4OTlmYzBiYmEwIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.VjNfA0-d55s8jYEEClR0LPtWUn5vtXNRBk4UvGsK2xlhJs0SfO3bHbJ6SCvFIMvTLsjjRavgyT_ri86lsCyPcIxq6eF91S1KtZWMBhIiuoPeXSr6OzFu0vwC5kjshatZYVF7R3Nhb1IsDeaIJinz4lARgG2d5YSAlI0WsUX-iCCUwe5lRFrxBfkPMblapN_FUurRH7ICfaR_A_L6lNXfPQcMIM0936ReV4LzUxKqfbA_ucH2YuaEZpJ9BFu4VzrEUNCHTZ5dnkhoShkQ8ib0iEYZiQooRGWSIiAC5nsV2RQNCM1t1fapdMk0wryv8xuK4D8yPkbdfYIW_P9MUoU_sg\",\"x-client-request-id\":\"f7e11f35-4a80-4a40-af3d-03b67ecfa05b\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"749940876\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=749940876&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.713Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:13.713Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:13.713Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-30T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-29T20:31:30.205Z\",\"ttl\":1772409600,\"ttl_datestamp\":\"2026-03-02T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"16ce474d...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:13.716Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-29T20:32:13.718Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:13.718Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-29T20:32:13.718Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Found persisted request\",\"status\":\"completed\"}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:13.718Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:13.719Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:13.718Z\",\"requestId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"178.231.187.149\",\"Gov-Client-Device-ID\":\"b7cb7267-085d-4d77-8833-acf2e7ea26a7\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"178.231.187.149\",\"Gov-Vendor-Forwarded\":\"by=178.231.187.149&for=178.231.187.149\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=1.0.0\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Multi-Factor\":\"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-29T20:32:12.481Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+01:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"obligations\\\":[{\\\"periodKey\\\":\\\"18A1\\\",\\\"start\\\":\\\"2017-01-01\\\",\\\"end\\\":\\\"2017-03-31\\\",\\\"due\\\":\\\"2017-05-07\\\",\\\"status\\\":\\\"F\\\",\\\"received\\\":\\\"2017-05-06\\\"},{\\\"periodKey\\\":\\\"18A2\\\",\\\"start\\\":\\\"2017-04-01\\\",\\\"end\\\":\\\"2017-06-30\\\",\\\"due\\\":\\\"2017-08-07\\\",\\\"status\\\":\\\"O\\\"}]}\"}}"}
[BROWSER CONSOLE log]: finished async request [GET /api/v1/hmrc/vat/obligation?vrn=749940876&from=2025-01-01&to=2025-12-01] (poll #1, elapsed: 1125ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT obligations retrieved. Type: success
[BROWSER CONSOLE log]: Hiding all status messages
[verifyVatObligationsResults] Found 2 obligation(s) - validating shape
VAT Period validated: 1 Jan 2017 to 31 Mar 2017
VAT Period validated: 1 Apr 2017 to 30 Jun 2017
Dates validated for 1 Jan 2017 to 31 Mar 2017: due=7 May 2017, received=6 May 2017
Dates validated for 1 Apr 2017 to 30 Jun 2017: due=7 Aug 2017, received=-
No test scenario 1 fulfilled obligations and 1 open obligations
VAT obligations retrieval completed successfully
Returning to home via main navigation...
[USER INTERACTION] Clicking: nav.main-nav a:has-text('Activities') - Clicking Activities in main navigation
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.151Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.151Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.240Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.236Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.275Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.274Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.304Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.305Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.305Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.306Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.305Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.306Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.306Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.308Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.308Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.309Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.309Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.310Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.310Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.392Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.392Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.407Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.406Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.410Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.410Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.410Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.410Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.411Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.412Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.412Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.412Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.413Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.413Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.413Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.513Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.513Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.513Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.513Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:15.513Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.514Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.514Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.516Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"read write\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njk3MTg2ODAsInNjb3BlIjoib3BlbmlkIHNvbWVzY29wZSIsImFtciI6WyJtZmEiLCJwd2QiXSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njk3MjIyODAsImlhdCI6MTc2OTcxODY4MCwibm9uY2UiOiI1Njc4IiwianRpIjoiNTIyYTg3ZTYtNWQ5Ni00NTYxLTkxMmYtNWQ1ZjNlOGZlNmNmIiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.Re49mWO0hTs0SfVOdDGnwUX9gI4JuR861qZxvsWO50ZykBYHQdMPAkTAM9srqm9Z5nIoLtho8eEqL8xBW5h4n8QGRR5UkP35mD9Y-dBF6FkYkacDgjwGtFnHNCd95Gfqk-6SfVc7s10SYbmGyQzAkFw2qdCNFGEfAXTdRHi6LY1AW19m-fcWN3y7AwbBozKwd9x8ifi6LxdSeNAofn4Cg_vAHN9WPnsRWfeJztA_H0y0sMmh8dxmQZQO8WvKsE6LiCKyASG7h1dx6xZy2m9SC9jtNS_GHMITN3DmpfVKNkRySyXAqpeHuJKgfiNPWgebkW_qycrf3LKR7Efj9CVQXg\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-forwarded-for\":\"178.231.187.149\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1769718680,\"scope\":\"openid somescope\",\"amr\":[\"mfa\",\"pwd\"],\"iss\":\"http://localhost:8080/default\",\"exp\":1769722280,\"iat\":1769718680,\"nonce\":\"5678\",\"jti\":\"522a87e6-5d96-4561-912f-5d5f3e8fe6cf\",\"email\":\"[REDACTED]\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.515Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.517Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.517Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.517Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.517Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:15.517Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.517Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:15.517Z\",\"requestId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"47103813-4a38-44e2-a1c5-f8768bc05a64\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.517Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.517Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.518Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-29T20:32:15.518Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-29T20:32:15.518Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-29T20:32:15.518Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-29T20:32:15.518Z\",\"requestId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"correlationId\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"traceparent\":\"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01\",\"x-correlationid\":\"d7e1289b-c797-44e0-bb20-0733e9f867af\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-30T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-29T20:31:30.205Z\\\",\\\"ttl\\\":1772409600,\\\"ttl_datestamp\\\":\\\"2026-03-02T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.518Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
[test body] Found userInfo in localStorage for test "Click through: Submit a VAT return to HMRC": {"sub":"user","email":"user@example.com"}
[test body] Extracted userSub from localStorage for test "Click through: Submit a VAT return to HMRC": user
Logging out from home page
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.592Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.592Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.635Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.635Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: a:has-text('Logout') - Logout
[BROWSER CONSOLE log]: Logging out user
[HTTP REQUEST FAILED] GET https://wanted-finally-anteater.ngrok-free.app/index.html - net::ERR_ABORTED
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.886Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.886Z\",\"msg\":\"HTTP GET /auth/login.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.972Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.972Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.972Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.972Z\",\"msg\":\"HTTP GET /images/g-logo.png\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.974Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.973Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.996Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.996Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.996Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.996Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.996Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.996Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.996Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.996Z\",\"msg\":\"HTTP GET /developer-mode.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.997Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.997Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:15.999Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:15.999Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.000Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.000Z\",\"msg\":\"HTTP GET /lib/utils/crypto-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.001Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.000Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.002Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.002Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.004Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.004Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.004Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.004Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.114Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.114Z\",\"msg\":\"HTTP GET /lib/services/hmrc-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.115Z\",\"msg\":\"HTTP GET /lib/services/auth-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.117Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.116Z\",\"msg\":\"HTTP GET /lib/services/catalog-service.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.117Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.117Z\",\"msg\":\"HTTP GET /lib/services/api-client.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.117Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.117Z\",\"msg\":\"HTTP GET /lib/utils/correlation-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.118Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.118Z\",\"msg\":\"HTTP GET /lib/utils/storage-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.119Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.119Z\",\"msg\":\"HTTP GET /lib/utils/jwt-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.119Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.119Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.120Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.120Z\",\"msg\":\"HTTP GET /lib/utils/dom-utils.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.121Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.120Z\",\"msg\":\"HTTP GET /auth/login-mock-addon.js\"}"}
[BROWSER CONSOLE error]: Loading the image 'https://avatars.githubusercontent.com/u/11848947?s=48&v=4' violates the following Content Security Policy directive: "img-src 'self' data:". The action has been blocked.
[HTTP REQUEST FAILED] GET https://avatars.githubusercontent.com/u/11848947?s=48&v=4 - csp
[BROWSER CONSOLE error]: Loading the script 'https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js' violates the following Content Security Policy directive: "script-src 'self' 'unsafe-inline'". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback. The action has been blocked.
[HTTP REQUEST FAILED] GET https://client.rum.us-east-1.amazonaws.com/1.25.0/cwr.js - csp
[BROWSER CONSOLE warning]: Failed to load RUM client: Event
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.226Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.226Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.231Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.231Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.283Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.283Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[Figures]: Selected 5 key screenshots from target/behaviour-test-results/screenshots/submitVat-behaviour-test
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T20:32:16.290Z","msg":"Copied screenshot: 2026-01-29_20-31-37-438181687-10-fill-in-submission-pagedown.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T20:32:16.290Z","msg":"Copied screenshot: 2026-01-29_20-31-51-195796598-02-complete-vat-receipt.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T20:32:16.291Z","msg":"Copied screenshot: 2026-01-29_20-31-45-000826299-01-submit-hmrc-auth.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T20:32:16.291Z","msg":"Copied screenshot: 2026-01-29_20-32-06-699983747-04-view-vat-return-results.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T20:32:16.292Z","msg":"Copied screenshot: 2026-01-29_20-31-19-091458140-01-submit-mock.png"}
[Figures]: Copied 5 screenshots to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-29T20:32:16.293Z","msg":"Wrote figures.json with 5 entries to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/figures.json"}
[Figures]: Generated figures.json in /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour
[DynamoDB Export]: Starting export of all tables...
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.293Z","msg":"[dynamodb-export]: Starting export of all tables to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.293Z","msg":"[dynamodb-export]: Exporting table 'test-bundle-table' from endpoint 'http://127.0.0.1:55871' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.305Z","msg":"[dynamodb-export]: ✅ Exported 1 items from table 'test-bundle-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.305Z","msg":"[dynamodb-export]: ── BEGIN bundles.jsonl ──"}
{"bundleId":"test","expiry":"2026-01-30T00:00:00.000Z","hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","createdAt":"2026-01-29T20:31:30.205Z","ttl":1772409600,"ttl_datestamp":"2026-03-02T00:00:00.000Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.305Z","msg":"[dynamodb-export]: ── END bundles.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.305Z","msg":"[dynamodb-export]: Exporting table 'test-hmrc-api-requests-table' from endpoint 'http://127.0.0.1:55871' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:16.315Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-29T20:32:16.311Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.315Z","msg":"[dynamodb-export]: ✅ Exported 14 items from table 'test-hmrc-api-requests-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.316Z","msg":"[dynamodb-export]: ── BEGIN hmrc-api-requests.jsonl ──"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-008d954b-4fa2-4650-a2aa-cf8a00c8bb84","requestId":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"476876a9-9ff5-4faa-8e05-2cea4210309d","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:31:49.588Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"110","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:49 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"_rJm9j7l-DYu6SlhtsrN9xvtHQnonppHON49Se2yeW8N8JWqhDqXjw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"8bbdc7f3-22bf-46c7-8f5f-49fb68237f95","x-envoy-upstream-service-time":"17","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"O"}]}},"duration":161,"createdAt":"2026-01-29T20:31:49.970Z","ttl":1772397109,"ttl_datestamp":"2026-03-01T20:31:49.970Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-00beed74-8a32-48d4-98e7-192058fe3065","requestId":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"476876a9-9ff5-4faa-8e05-2cea4210309d","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:31:49.588Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:49 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"ArvzoVdzy6M6T8IIo-UQgyDZoYd47NXZfYlxR1pr479XNmJl8UhwRw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"38","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":164,"createdAt":"2026-01-29T20:31:49.805Z","ttl":1772397109,"ttl_datestamp":"2026-03-01T20:31:49.805Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-16012503-677f-4b91-9c9d-3bb2f038565d","requestId":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"476876a9-9ff5-4faa-8e05-2cea4210309d","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:31:49.588Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:50 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"N_UveOcjcMFYK9HQGsp2pxpHMTig_o_MLaBM2R3Bzl2N0aygI6sOoQ==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"15","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":147,"createdAt":"2026-01-29T20:31:50.123Z","ttl":1772397110,"ttl_datestamp":"2026-03-01T20:31:50.123Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-505c1e5a-98c9-4445-b96f-290706291de8","requestId":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"8ded02cf-27a9-4956-a0b5-92c7254e8fce","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:02.601Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:03 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 97eaba44803576cf9f5d9993fc05ccee.cloudfront.net (CloudFront)","x-amz-cf-id":"Zg8Wia6aZh-B3u7JY628126aQ8Z3LMFN0Dta9_fxk3FMn0OiaXHW6w==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"20","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":151,"createdAt":"2026-01-29T20:32:03.222Z","ttl":1772397123,"ttl_datestamp":"2026-03-01T20:32:03.222Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-6e277ce8-31bc-4c6c-b05a-cb361cf251ce","requestId":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"476876a9-9ff5-4faa-8e05-2cea4210309d","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:31:49.588Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:51 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"iqmB1Z9W12T4aJsw8tU_GG51O4F9-tVolWTBEGekWcwPqZnkT3Tf8w==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"19","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":116,"createdAt":"2026-01-29T20:31:51.201Z","ttl":1772397111,"ttl_datestamp":"2026-03-01T20:31:51.201Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-85c96962-5a5f-4a39-b744-1567daaadf4d","requestId":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"8ded02cf-27a9-4956-a0b5-92c7254e8fce","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:02.601Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:02 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 97eaba44803576cf9f5d9993fc05ccee.cloudfront.net (CloudFront)","x-amz-cf-id":"Kibhep9gLdnuAJHC7rEdRgugu-XTKhTA4qAiyEsGQY_67rgDc_sZMg==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"21","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":206,"createdAt":"2026-01-29T20:32:02.896Z","ttl":1772397122,"ttl_datestamp":"2026-03-01T20:32:02.896Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-863ec9da-51e6-46b6-b2a1-67c65e3ae0fc","requestId":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"8ded02cf-27a9-4956-a0b5-92c7254e8fce","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:02.601Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"242","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:03 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 97eaba44803576cf9f5d9993fc05ccee.cloudfront.net (CloudFront)","x-amz-cf-id":"KgKToKzBoraTHOC7I7ZZnlxPArT4VvvzkPL_jO3yClPb-IgRQJ9yQw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"38b36f2f-614a-42a5-8ad9-602ea1b62a41","x-envoy-upstream-service-time":"19","x-frame-options":"SAMEORIGIN"},"body":{"periodKey":"18A1","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":5000,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0}},"duration":228,"createdAt":"2026-01-29T20:32:03.453Z","ttl":1772397123,"ttl_datestamp":"2026-03-01T20:32:03.453Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-9dd17f52-ca29-4271-990d-33d9254f5abb","requestId":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"8ded02cf-27a9-4956-a0b5-92c7254e8fce","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:02.601Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"489","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:04 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 97eaba44803576cf9f5d9993fc05ccee.cloudfront.net (CloudFront)","x-amz-cf-id":"2yW1w-ua1gDiM-Ml7w7secw3IvchYvNP8WcgaDz7q_hh6B9kxPOGTQ==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"19","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"***MASKED***","message":"At least 1 header is invalid","errors":[{"code":"***MASKED***","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"***MASKED***","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":527,"createdAt":"2026-01-29T20:32:04.684Z","ttl":1772397124,"ttl_datestamp":"2026-03-01T20:32:04.684Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-b24dd4d5-f343-4f99-ac02-0b4b92125be6","requestId":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"8ded02cf-27a9-4956-a0b5-92c7254e8fce","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:02.601Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"134","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:05 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 97eaba44803576cf9f5d9993fc05ccee.cloudfront.net (CloudFront)","x-amz-cf-id":"39dffhuDJ22qOoafdMrc6PkFOIHesw2Eld1n5Oas6rvjx050OxDDVQ==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"fa00b9f6-c204-467b-80a1-ffb876999f87","x-envoy-upstream-service-time":"15","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"}]}},"duration":530,"createdAt":"2026-01-29T20:32:05.216Z","ttl":1772397125,"ttl_datestamp":"2026-03-01T20:32:05.216Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-b946c6e7-4977-4b19-a1be-8708c134f216","requestId":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=F","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"1e360d62-4589-4ea4-a7f0-8ebfcccdb252","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"8ded02cf-27a9-4956-a0b5-92c7254e8fce","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:02.601Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"134","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:03 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 97eaba44803576cf9f5d9993fc05ccee.cloudfront.net (CloudFront)","x-amz-cf-id":"krNtyUtyHll48xSxSg3VIgI8hxTnYl2dP2qkKluOxeaHvRqHKClTSw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"59272b28-3232-480c-8da0-27980ac1c83d","x-envoy-upstream-service-time":"14","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"}]}},"duration":168,"createdAt":"2026-01-29T20:32:03.067Z","ttl":1772397123,"ttl_datestamp":"2026-03-01T20:32:03.067Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-c2594061-82f7-4ccb-884d-091b03b67de5","requestId":"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2025-01-01&to=2025-12-01","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"cdbd9b30-ba6a-4613-a7dd-0ed0a0434481","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"b7cb7267-085d-4d77-8833-acf2e7ea26a7","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:32:12.481Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"227","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:32:12 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 1a89beee9d72657437f5e91f57220804.cloudfront.net (CloudFront)","x-amz-cf-id":"Te8XKQFgVW_s1eukqd4ZAIYtcfeJk0JqwnN4Nd5bKSSLTBbo_PFClw==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"a772387b-ee78-487c-92ee-0c6e8e1d8dbb","x-envoy-upstream-service-time":"18","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"},{"periodKey":"18A2","start":"2017-04-01","end":"2017-06-30","due":"2017-08-07","status":"O"}]}},"duration":324,"createdAt":"2026-01-29T20:32:12.907Z","ttl":1772397132,"ttl_datestamp":"2026-03-01T20:32:12.907Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-cec95ad8-8b9c-425c-8aa1-71059d5aa797","requestId":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/obligations?from=2017-01-01&to=2017-03-31&status=O","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"476876a9-9ff5-4faa-8e05-2cea4210309d","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:31:49.588Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"110","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:51 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"fYbrrl09nxg6DxKy2y_Q9l29Qn28FADBtJgty7TLYwrIfedLUiaJ0Q==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"6a90169e-d717-4698-8c85-a2d1d9974a4c","x-envoy-upstream-service-time":"16","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"O"}]}},"duration":143,"createdAt":"2026-01-29T20:31:51.347Z","ttl":1772397111,"ttl_datestamp":"2026-03-01T20:31:51.347Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-e3d66121-2814-427f-8029-1b569d062484","requestId":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns","method":"POST","httpRequest":{"method":"POST","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"***MASKED***","x-request-id":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"8a6a2334-35ba-4eb0-a029-c99ebcf439bc","Gov-Client-Public-IP":"178.231.187.149","Gov-Client-Device-ID":"476876a9-9ff5-4faa-8e05-2cea4210309d","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"178.231.187.149","Gov-Vendor-Forwarded":"by=178.231.187.149&for=178.231.187.149","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=1.0.0","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Multi-Factor":"type=TOTP&timestamp=2026-01-08T00%3A09%3A01Z&unique-reference=test-mfa-1769718682290","Gov-Client-Public-IP-Timestamp":"2026-01-29T20:31:49.588Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+01:00","Gov-Client-Window-Size":"width=1280&height=1446"},"body":"{\"periodKey\":\"18A1\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":5000,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0,\"finalised\":true}"},"httpResponse":{"statusCode":201,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"140","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:50 GMT","receipt-id":"87c53d0b-b52c-4019-a0b0-e67b7fd2ce14","receipt-signature":"This has been deprecated - DO NOT USE","receipt-timestamp":"2026-01-29T20:31:50Z","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"YmNdAX7U8lXrW7rtezj1hoWAzWPHOECmYsWpaxOGGiK7Pqpkm1Dn3g==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"87c53d0b-b52c-4019-a0b0-e67b7fd2ce14","x-envoy-upstream-service-time":"44","x-frame-options":"SAMEORIGIN"},"body":{"processingDate":"2026-01-29T20:31:50.307Z","formBundleNumber":"034899331243","paymentIndicator":"DD","chargeRefNumber":"unDzc87fo6opxqky"}},"duration":201,"createdAt":"2026-01-29T20:31:50.329Z","ttl":1772397110,"ttl_datestamp":"2026-03-01T20:31:50.329Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-f0766822-2539-46d6-9e02-3020ee5e35b4","requestId":"bdabd5e6-dd10-4723-8753-580ef2bcee53","amznTraceId":null,"traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","url":"https://test-api.service.hmrc.gov.uk/oauth/token","method":"POST","httpRequest":{"method":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","x-request-id":"bdabd5e6-dd10-4723-8753-580ef2bcee53","traceparent":"00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01","x-correlationid":"bdabd5e6-dd10-4723-8753-580ef2bcee53"},"body":"grant_type=authorization_code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&client_secret=***MASKED***&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&code=***MASKED***"},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"172","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 29 Jan 2026 20:31:49 GMT","strict-transport-security":"max-age=31536000;","via":"1.1 045d55468661252b6be78e701e36b492.cloudfront.net (CloudFront)","x-amz-cf-id":"YBUw9J5r5oPFf1lbkm_93MP2Fw6OaTPZGx7AYpRWOgJcuxVFuWXt9Q==","x-amz-cf-pop":"AMS1-P1","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"59","x-frame-options":"SAMEORIGIN"},"body":{"access_token":"***MASKED***","refresh_token":"***MASKED***","expires_in":14400,"scope":"write:vat read:vat","token_type":"bearer"}},"duration":259,"createdAt":"2026-01-29T20:31:49.156Z","ttl":1772397109,"ttl_datestamp":"2026-03-01T20:31:49.156Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.316Z","msg":"[dynamodb-export]: ── END hmrc-api-requests.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.316Z","msg":"[dynamodb-export]: Exporting table 'test-receipts-table' from endpoint 'http://127.0.0.1:55871' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.320Z","msg":"[dynamodb-export]: ✅ Exported 1 items from table 'test-receipts-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.320Z","msg":"[dynamodb-export]: ── BEGIN receipts.jsonl ──"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","receiptId":"2026-01-29T20:31:50.333Z-034899331243","receipt":{"processingDate":"2026-01-29T20:31:50.307Z","formBundleNumber":"034899331243","paymentIndicator":"DD","chargeRefNumber":"unDzc87fo6opxqky"},"createdAt":"2026-01-29T20:31:50.334Z","ttl":1990470710,"ttl_datestamp":"2033-01-27T20:31:50.334Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.320Z","msg":"[dynamodb-export]: ── END receipts.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-29T20:32:16.320Z","msg":"[dynamodb-export]: ✅ Completed export of all tables"}
[DynamoDB Export]: Export completed: [
  {
    table: [32m'bundles'[39m,
    itemCount: [33m1[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'[39m
  },
  {
    table: [32m'hmrc-api-requests'[39m,
    itemCount: [33m14[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'[39m
  },
  {
    table: [32m'receipts'[39m,
    itemCount: [33m1[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'[39m
  }
]
Asserting HMRC API request exists: POST /oauth/token
[DynamoDB Assertions]: Found 1 OAuth token exchange request(s)
Asserting HMRC API request exists: POST /organisations/vat/749940876/returns
[DynamoDB Assertions]: Found 1 VAT return POST request(s)
Matched all expected values in https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns: { [32m'httpRequest.method'[39m: [32m'POST'[39m, [32m'httpResponse.statusCode'[39m: [33m201[39m }
[DynamoDB Assertions]: VAT POST request body validated - periodKey format: 18A1
Asserting HMRC API request exists: GET /\/organisations\/vat\/749940876\/returns\/\w+/
[DynamoDB Assertions]: Found 1 VAT return GET request(s)
Matched all expected values in https://test-api.service.hmrc.gov.uk/organisations/vat/749940876/returns/18A1: { [32m'httpRequest.method'[39m: [32m'GET'[39m, [32m'httpResponse.statusCode'[39m: [33m200[39m }
[DynamoDB Assertions]: VAT GET response body validated - periodKey format: 18A1
[DynamoDB Assertions]: Found 0 Fraud prevention headers validation feedback GET request(s)
Asserting HMRC API request exists: GET /test/fraud-prevention-headers/validate
[DynamoDB Assertions]: Found 6 Fraud prevention headers validation GET request(s)
[DynamoDB Assertions]: Fraud prevention headers validation GET request #1 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #2 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #3 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #4 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #5 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
[DynamoDB Assertions]: Fraud prevention headers validation GET request #6 validated successfully with details:
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 1
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Request code: ***MASKED***
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
{"level":30,"source":"behaviour-tests/helpers/dynamodb-assertions.js","time":"2026-01-29T20:32:16.359Z","msg":"Found 14 HMRC API requests: OAuth (1) with hashedSub 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0, authenticated (13) with hashedSub 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0"}
[DynamoDB Assertions]: Found 1 unique hashedSub value(s): 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0
[afterEach] Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/userSub.txt for test "Click through: Submit a VAT return to HMRC": user
{"level":30,"source":"app/services/subHasher.js","time":"2026-01-29T20:32:16.462Z","message":"Using USER_SUB_HASH_SALT from environment (local dev/test)"}
[fileHelper] Salt initialized successfully for test diagnostics
[afterEach] Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hashedUserSub.txt for test "Click through: Submit a VAT return to HMRC": 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0
Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/traceparent.txt for test "Click through: Submit a VAT return to HMRC": 00-098c6e34a30bba1f204955481d6fcb0d-d2a869d490e6d6a0-01
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-29T20:32:18.344Z","msg":"[proxy]: kill() called on ngrok proxy, stopping..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T20:32:18.344Z","msg":"[ngrok]: Closing tunnel..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-29T20:32:18.405Z","msg":"[ngrok]: ✅ Tunnel closed"}
  ✓  1 [submitVatBehaviour] › behaviour-tests/submitVat.behaviour.test.js:182:1 › Click through: Submit a VAT return to HMRC (1.1m)

  1 passed (1.3m)

To open last HTML report run:
[36m[39m
[36m  npx playwright show-report target/test-reports/html-report[39m
[36m[39m
