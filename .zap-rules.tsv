# ZAP Baseline Scan Rules Configuration
# Format: rule_id	action	comment
# Actions: IGNORE (don't report), WARN (report but don't fail), FAIL (report and fail)
# See: https://www.zaproxy.org/docs/docker/baseline-scan/

# Information Disclosure - typically informational
10020	WARN	X-Frame-Options header missing (handled by CSP frame-ancestors)
10021	WARN	X-Content-Type-Options header missing
10036	WARN	Server leaks version information
10037	WARN	Server leaks information via X-Powered-By

# Security Headers - we handle these at CloudFront/WAF level
10038	WARN	Content Security Policy header missing
10039	WARN	X-XSS-Protection header missing (deprecated)
10098	WARN	Cross-Domain Misconfiguration

# Cookie-related - we use localStorage, not cookies
10054	IGNORE	Cookie without SameSite attribute
10055	IGNORE	Cookie without Secure flag
10056	IGNORE	Cookie without HttpOnly flag
90033	IGNORE	Loosely scoped cookie

# Common false positives
10015	WARN	Incomplete or no cache-control header
10017	WARN	Cross-domain JavaScript source file inclusion
10019	WARN	Content-Type header missing
10024	WARN	Information disclosure via sensitive information in URL
10027	WARN	Information disclosure via suspicious comments
10109	WARN	Modern web application (informational)
10110	WARN	Dangerous JS function

# SSL/TLS - handled by AWS CloudFront
10011	IGNORE	Cookie without secure flag (AWS handles HTTPS)

# Application-specific ignores
40025	WARN	Proxy disclosure
90022	WARN	Application error disclosure
90011	WARN	Charset mismatch

# Critical rules that should always fail
10016	FAIL	Web browser XSS protection not enabled
10035	FAIL	Strict-Transport-Security header not set
10040	FAIL	Secure pages include mixed content
10045	FAIL	Source code disclosure
10095	FAIL	Backup file disclosure
10105	FAIL	Weak authentication method
10106	FAIL	HTTP only site
10202	FAIL	Absence of anti-CSRF tokens
30001	FAIL	Buffer overflow
30002	FAIL	Format string error
40003	FAIL	CRLF injection
40008	FAIL	Parameter tampering
40009	FAIL	Server-side include
40012	FAIL	Cross-site scripting (reflected)
40013	FAIL	Session ID in URL rewrite
40014	FAIL	Cross-site scripting (persistent)
40016	FAIL	Cross-site scripting (DOM-based)
40017	FAIL	Cross-site scripting (reflected)
40018	FAIL	SQL injection
40019	FAIL	SQL injection (MySQL)
40020	FAIL	SQL injection (Hypersonic)
40021	FAIL	SQL injection (Oracle)
40022	FAIL	SQL injection (PostgreSQL)
40024	FAIL	SQL injection (SQLite)
40026	FAIL	Cross-site scripting (DOM-based)
40027	FAIL	SQL injection (MsSQL)
40028	FAIL	ELMAH information leak
40029	FAIL	Trace.axd information leak
40031	FAIL	Out of band XSS
40032	FAIL	Integer overflow error
40034	FAIL	LDAP injection
40035	FAIL	Server-side template injection
40038	FAIL	Persistent XSS (prime)
40039	FAIL	Persistent XSS (spider)
40040	FAIL	Persistent XSS (attack)
90017	FAIL	XSLT injection
90018	FAIL	SQL injection (SQLite - time-based)
90019	FAIL	Server-side code injection
90020	FAIL	Remote OS command injection
90021	FAIL	XPath injection
90023	FAIL	XML external entity attack
90024	FAIL	Generic padding oracle
90025	FAIL	Expression language injection
90028	FAIL	Insecure HTTP method
90029	FAIL	SOAP XML injection
90030	FAIL	WSDL file detection
90034	FAIL	Cloud metadata potentially exposed
