version = "1.1.0"

[[bundles]]
id = "default"
name = "Default"
allocation = "automatic"
auth = "none"

[[bundles]]
id = "test"
name = "Test"
allocation = "on-request"
auth = "required"
cap = 10
timeout = "P1D"

#[[bundles]]
#id = "guest"
#name = "Guest"
#allocation = "on-request"
#auth = "required"
#cap = 10
#timeout = "P1M"

#[[bundles]]
#id = "legacy"
#name = "Legacy"
#allocation = "on-request"
#auth = "required"
#cap = 1000
#timeout = "P1Y"
#[bundles.qualifiers]
#requiresTransactionId = true

#[[bundles]]
#id = "basic"
#name = "Basic"
#allocation = "on-request"
#auth = "required"
#[bundles.qualifiers]
#subscriptionTier = "Basic"

#[[bundles]]
#id = "advanced"
#name = "Advanced"
#allocation = "on-request"
#auth = "required"
#[bundles.qualifiers]
#subscriptionTier = "Advanced"

# TODO: Add a widget to each page that extracts the bundles from the JWT, and the related paths from the catalogue, then checks one of the paths matches the page
# and shows a lock icon or an unlock icon accordingly with a tooltip showing which bundles grant the activity (so the bundles should be claims)
[[activities]]
id = "my-receipts"
name = "View previously submitted receipts"
bundles = ["default"]
path = "account/receipts.html"

# TODO: Create an authorizer that extracts the bundles from the JWT, and the related paths from the catalogue, then checks one of the paths matches the request
# and an HTTP error 403 is returned accordingly with a payload showing which bundles grant the matching activity (so the bundles should be claims)
[[activities]]
id = "catalogue"
name = "View the product catalogue"
bundles = ["default"]
paths = ["^/api/v1/catalogue.*"]

[[activities]]
id = "bundle"
name = "View and edit your bundles"
bundles = ["default"]
paths = ["account/bundles.html", "^/api/v1/bundle.*"]

# VAT activities
[[activities]]
id = "submit-vat-sandbox"
name = "Submit VAT (Sandbox API)"
bundles = ["test"]
path = "activities/submitVat.html"
# tags = ["sandbox"]

[[activities]]
id = "vat-obligations-sandbox"
name = "VAT Obligations (Sandbox API)"
bundles = ["test"]
path = "activities/vatObligations.html"
# tags = ["sandbox"]

[[activities]]
id = "view-vat-return-sandbox"
name = "View VAT Return (Sandbox API)"
bundles = ["test"]
path = "activities/viewVatReturn.html"
# tags = ["sandbox"]

[[activities]]
id = "test"
name = "View and edit your bundles"
bundles = ["test"]
path = "^/api/hmrc/vat.*"
type = "api"

[[activities]]
id = "submit-vat"
name = "Submit VAT"
bundles = ["guest", "basic", "legacy"]
path = "activities/submitVat.html"

# Placeholder activities
#[[activities]]
#id = "learn-free-anon"
#name = "Learn about free anonymous activities"
#bundles = ["default"]

#[[activities]]
#id = "learn-free-auth"
#name = "Learn about free authenticated activities"
#bundles = ["guest"]

#[[activities]]
#id = "learn-basic"
#name = "Learn about basic activities"
#bundles = ["basic"]

#[[activities]]
#id = "learn-legacy"
#name = "Learn about DIY legacy entitlements"
#bundles = ["legacy"]

#[[activities]]
#id = "learn-advanced"
#name = "Learn about advanced activities"
#bundles = ["advanced"]

#[[activities]]
#id = "vat-obligations"
#name = "VAT Obligations"
#bundles = ["default"]
#path = "account/receipts.html"

#[[activities]]
#id = "self-employed"
#name = "Self Employed"
#bundles = ["basic", "legacy"]

#[[activities]]
#id = "diy-basic-sole-trader-upload"
#name = "DIY Basic Sole Trader Upload"
#bundles = ["legacy"]

#[[activities]]
#id = "diy-taxi-upload"
#name = "DIY Taxi Upload"
#bundles = ["legacy"]

#[[activities]]
#id = "diy-self-employed-upload"
#name = "DIY Self-Employed Upload"
#bundles = ["legacy"]

#[[activities]]
#id = "diy-limited-company-upload"
#name = "DIY Limited Company Upload"
#bundles = ["legacy"]
