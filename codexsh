#!/usr/bin/env bash
# Run to create a new Codex workspace in a Docker container and ssh into it.

set -euo pipefail

# 1) Build the image (oneâ€‘time)
docker build -f .codex/Dockerfile -t diyacct-codex .

# 2) Run interactively, forwarding your SSH agent & Codex cred dir
# -e SSH_AUTH_SOCK_HOST="$SSH_AUTH_SOCK" \
# -v "$SSH_AUTH_SOCK":"$SSH_AUTH_SOCK_HOST":ro \
docker run -it \
  --init \
  -v "${HOME}/.codex":/host_codex:ro \
  -v "$(pwd)":/host_workdir:ro \
  diyacct-codex
